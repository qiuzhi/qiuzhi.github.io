<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>玩乐随心 - 分类 - 秋至、枫以落</title><link>https://blog.iqzhi.com/categories/%E7%8E%A9%E4%B9%90%E9%9A%8F%E5%BF%83/</link><description>玩乐随心 - 分类 - 秋至、枫以落</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Wed, 20 Dec 2023 09:20:05 +0800</lastBuildDate><atom:link href="https://blog.iqzhi.com/categories/%E7%8E%A9%E4%B9%90%E9%9A%8F%E5%BF%83/" rel="self" type="application/rss+xml"/><item><title>记一次CentOS磁盘扩容操作</title><link>https://blog.iqzhi.com/posts/centos-disk-expansion/</link><pubDate>Wed, 20 Dec 2023 09:20:05 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/centos-disk-expansion/</guid><description><![CDATA[<p>前期安装的CentOS，专门拿来挂机跑青龙、机器人等项目，当时估算的磁盘分配少了，监控程序一直处于黄色告警，虽然不影响正常使用，但有空还是处理下为好，正常的资源利用率更有利于系统稳定运行。</p>
<h2 id="一-lvm概述">一 LVM概述</h2>
<ul>
<li>
<p>在 Linux 系统中，我们经常使用 LVM （逻辑卷管理）的方式去管理和使用磁盘， LVM 可以动态扩容，给我们的使用带来了很多的便捷性。</p>
</li>
<li>
<p>LVM结构图如下：</p>
<figure><a class="lightgallery" href="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png?size=large" data-thumbnail="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png?size=small" data-sub-html="<h2>LVM结构图</h2><p>LVM结构图</p>"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png?size=large 2x" sizes="auto" data-title="LVM结构图" data-alt="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-57-16-20231220105716.png" width="50%" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></a><figcaption class="image-caption">LVM结构图</figcaption>
    </figure>
<ul>
<li>物理卷（Physical Volume，PV）
指磁盘分区或从逻辑上与磁盘分区具有同样功能的设备（如RAID），是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数。</li>
<li>卷组（Volume Group，VG）
类似于非LVM系统中的物理磁盘，其由一个或多个物理卷PV组成。可以在卷组上创建一个或多个LV（逻辑卷）。</li>
<li>逻辑卷（Logical Volume，LV）
类似于非LVM系统中的磁盘分区，逻辑卷建立在卷组VG之上。在逻辑卷LV之上可以建立文件系统（比如/home或者/usr等）。</li>
</ul>
</li>
</ul>
<h2 id="二-esxi修改磁盘大小">二 ESXi修改磁盘大小</h2>
<p>打开ESXi中需要增加的虚拟机配置界面，直接修改硬盘大小（下图红框所示），点击保存，然后重启虚拟机即可。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-31-55-20231220103154.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-31-55-20231220103154.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-31-55-20231220103154.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-10-31-55-20231220103154.png?size=large 2x" sizes="auto" data-title="ESXi修改原磁盘大小" data-alt="ESXi修改原磁盘大小" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>至此，ESXi操作完毕。</p>
<h2 id="三-centos扩容">三 CentOS扩容</h2>
<p>使用SSH终端连接CentOS操作后续步骤。</p>
<p><strong>核心思想：使用增加的磁盘空间创建一个新PV，跟原有的PV接接，整合到同一个LV上去，完成扩容。</strong></p>
<h3 id="观察系统是否正常识别需要扩容的空间">观察系统是否正常识别需要扩容的空间</h3>
<p>使用<code>lsblk</code>查看磁盘分配情况</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-00-12-20231220110012.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-00-12-20231220110012.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-00-12-20231220110012.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-00-12-20231220110012.png?size=large 2x" sizes="auto" data-title="原磁盘状态1" data-alt="原磁盘状态1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>使用<code>fdisk -l</code>确认</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-02-05-20231220110205.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-02-05-20231220110205.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-02-05-20231220110205.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-02-05-20231220110205.png?size=large 2x" sizes="auto" data-title="原磁盘状态2" data-alt="原磁盘状态2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>在ESXi增加了磁盘大小重启后，再次使用<code>lsblk</code></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-03-49-20231220110349.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-03-49-20231220110349.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-03-49-20231220110349.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-03-49-20231220110349.png?size=large 2x" sizes="auto" data-title="增加磁盘空间后的磁盘状态1" data-alt="增加磁盘空间后的磁盘状态1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以看到，<code>sda</code>总大小为64G，较原有的20G多了44G。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-08-48-20231220110847.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-08-48-20231220110847.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-08-48-20231220110847.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-08-48-20231220110847.png?size=large 2x" sizes="auto" data-title="增加磁盘空间后的磁盘状态2" data-alt="增加磁盘空间后的磁盘状态2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="对新增加的空间进行分区格式化">对新增加的空间进行分区格式化</h3>
<p>使用<code>fdisk</code>命令启动格式化</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-16-38-20231220111636.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-16-38-20231220111636.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-16-38-20231220111636.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-16-38-20231220111636.png?size=large 2x" sizes="auto" data-title="格式化并新建PV" data-alt="格式化并新建PV" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>完成上述命令后，可观察终端输出，一般可能出现一些WARNING，说系统繁忙，我们直接重启虚拟机，能正常进入即成功。</p>
<h3 id="新建pv">新建PV</h3>
<p>使用<code>pvs</code>查看PV</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-25-27-20231220112527.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-25-27-20231220112527.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-25-27-20231220112527.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-25-27-20231220112527.png?size=large 2x" sizes="auto" data-title="查看PV1" data-alt="查看PV1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>创建新PV<code>pvcreate /dev/sda3</code></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-27-39-20231220112739.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-27-39-20231220112739.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-27-39-20231220112739.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-27-39-20231220112739.png?size=large 2x" sizes="auto" data-title="新PV" data-alt="新PV" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>再次<code>pvs</code>确认</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-29-36-20231220112936.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-29-36-20231220112936.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-29-36-20231220112936.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-29-36-20231220112936.png?size=large 2x" sizes="auto" data-title="查看PV2" data-alt="查看PV2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="将新pv加入到vg">将新PV加入到VG</h3>
<p>使用<code>vgs</code>查看VG</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-35-21-20231220113521.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-35-21-20231220113521.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-35-21-20231220113521.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-35-21-20231220113521.png?size=large 2x" sizes="auto" data-title="查看VG1" data-alt="查看VG1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>使用<code>vgextend</code>进行增加</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-43-51-20231220114351.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-43-51-20231220114351.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-43-51-20231220114351.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-43-51-20231220114351.png?size=large 2x" sizes="auto" data-title="加入VG" data-alt="加入VG" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>再次<code>vgs</code>确认</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-42-38-20231220114237.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-42-38-20231220114237.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-42-38-20231220114237.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-42-38-20231220114237.png?size=large 2x" sizes="auto" data-title="查看VG2" data-alt="查看VG2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h3 id="扩容lv">扩容LV</h3>
<p>使用<code>lvs</code>查看LV</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-45-55-20231220114555.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-45-55-20231220114555.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-45-55-20231220114555.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-45-55-20231220114555.png?size=large 2x" sizes="auto" data-title="查看LV1" data-alt="查看LV1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>扩容43G空间到LV</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-49-32-20231220114932.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-49-32-20231220114932.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-49-32-20231220114932.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-49-32-20231220114932.png?size=large 2x" sizes="auto" data-title="扩容LV1" data-alt="扩容LV1" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>当初实际在ESXi加的是44G，但经过分区格式化后是不足44G的，在这里磁盘是有损耗的，一定要注意参数不要直接写44G，我们可以通过再加1G验证</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-51-47-20231220115147.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-51-47-20231220115147.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-51-47-20231220115147.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-51-47-20231220115147.png?size=large 2x" sizes="auto" data-title="扩容LV2" data-alt="扩容LV2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这次改用<code>lvdisplay</code>可以查看确认更详细的信息</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-54-30-20231220115429.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-54-30-20231220115429.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-54-30-20231220115429.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-54-30-20231220115429.png?size=large 2x" sizes="auto" data-title="查看LV2" data-alt="查看LV2" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>可以看到<code>root</code>下空间增至60G，扩容成功。</p>
<h3 id="刷新文件系统信息">刷新文件系统信息</h3>
<p>CentOS使用<code>xfs_growfs</code>刷新</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-57-38-20231220115738.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-57-38-20231220115738.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-57-38-20231220115738.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-57-38-20231220115738.png?size=large 2x" sizes="auto" data-title="刷新文件系统" data-alt="刷新文件系统" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><code>reboot</code>后重新进入，通过<code>df -h</code>查看系统空间情况，确认扩容成功。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-59-51-20231220115951.png" srcset="https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-59-51-20231220115951.png?size=small, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-59-51-20231220115951.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/qiuzhi/static/blog/2023-12-20-11-59-51-20231220115951.png?size=large 2x" sizes="auto" data-title="查看最终成果" data-alt="查看最终成果" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="四-总结">四 总结</h2>
<p>至此，本次扩容完成，整体较为顺利，多谢大佬<a href="http://www.qxzx.xyz/"target="_blank" rel="external nofollow noopener noreferrer">Frank</a>的远程指导操作，让我更深刻学习Linux基础，收益甚多！</p>
<h2 id="五-参考">五 参考</h2>
<ul>
<li><a href="https://www.jianshu.com/p/4c7acf819046"target="_blank" rel="external nofollow noopener noreferrer">LV扩容(lvextend)</a></li>
</ul>]]></description></item><item><title>Linux设置密钥登陆</title><link>https://blog.iqzhi.com/posts/linux-key-login/</link><pubDate>Tue, 12 Dec 2023 12:20:05 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/linux-key-login/</guid><description><![CDATA[<p>网上看了几篇对于Linux使用密钥登录的好文章，这里合并做个备用，如有系统安全类需求，这是一个很好的参考思路。</p>
<h2 id="方案一传统做法">方案一：传统做法</h2>
<p>转载：<a href="https://zset.cc/archives/25/"target="_blank" rel="external nofollow noopener noreferrer">【有序集合】Linux设置密钥登陆</a></p>
<p>首先在家目录下创建 <code>authorized_keys</code> 用于存放公钥，如果已有该文件可跳过</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir .ssh
</span></span><span class="line"><span class="cl">touch .ssh/authorized_keys</span></span></code></pre></td></tr></table>
</div>
</div><p>在 <code>authorized_keys</code> 文件中添加公钥，并修改文件权限</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod <span class="m">600</span> .ssh/authorized_keys
</span></span><span class="line"><span class="cl">chmod <span class="m">700</span> .ssh</span></span></code></pre></td></tr></table>
</div>
</div><p>编辑 <code>/etc/ssh/sshd_config</code> 文件，进行如下设置：</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">RSAAuthentication yes
</span></span><span class="line"><span class="cl">PubkeyAuthentication yes</span></span></code></pre></td></tr></table>
</div>
</div><p>另外，请留意 root 用户能否通过 SSH 登录：</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PermitRootLogin yes</span></span></code></pre></td></tr></table>
</div>
</div><p>当你完成全部设置，并以密钥方式登录成功后，再禁用密码登录：</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PasswordAuthentication no</span></span></code></pre></td></tr></table>
</div>
</div><p>最后，重启 SSH 服务：</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service sshd restart</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="方案二一键配置脚本">方案二：一键配置脚本</h2>
<p>转载：<a href="https://p3terx.com/archives/ssh-key-installer.html"target="_blank" rel="external nofollow noopener noreferrer">【P3TERX ZONE】SSH 密钥一键配置脚本 使用教程</a></p>
<p>对于新入手或重装后的 VPS 配置密钥登录需要创建 <code>~/.ssh</code> 目录、把公钥写入到 <code>~/.ssh/authorized_keys</code>、设置权限、禁用密码登录等操作，虽然都是很简单的基础操作，但过程麻烦且枯燥：</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -p ~/.ssh
</span></span><span class="line"><span class="cl">curl -fsSL https://github.com/P3TERX.keys &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">chmod <span class="m">700</span> ~/.ssh
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">sudo sed -i <span class="s2">&#34;s@.*\(PasswordAuthentication \).*@\1no@&#34;</span> /etc/ssh/sshd_config
</span></span><span class="line"><span class="cl">sudo service sshd restart</span></span></code></pre></td></tr></table>
</div>
</div><p>SSH 密钥一键配置脚本是一套用于简化 SSH 密钥配置过程的解决方案。使用它以上操作只需要一行命令：</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -g P3TERX -d</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="语法及选项说明">语法及选项说明</h3>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> <span class="o">[</span>选项...<span class="o">]</span> &lt;参数&gt;</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>-o - 覆盖模式，必须写在最前面才会生效</li>
<li>-g - 从 GitHub 获取公钥，参数为 GitHub 用户名</li>
<li>-u - 从 URL 获取公钥，参数为 URL</li>
<li>-f - 从本地文件获取公钥，参数为本地文件路径</li>
<li>-p - 修改 SSH 端口，参数为端口号</li>
<li>-d - 禁用密码登录</li>
</ul>
<h3 id="使用方法">使用方法</h3>
<h4 id="生成-ssh-密钥对">生成 SSH 密钥对</h4>
<p>如果没有密钥需要先生成，执行以下命令后一路回车即可。</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh-keygen -t ecdsa -b <span class="m">521</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<blockquote>
<p>TIPS： 此方法适用于 Win­dows 10 (1803后)的 Pow­er­Shell 或 WSL，Linux 发行版和 ma­cOS 自带的终端，但不仅限于这些环境。
科普： 521 位的 ECDSA 密钥比起 RSA 密钥更安全且验证速度更快。</p>
</blockquote>
</blockquote>
<p>操作完后会在 <code>~/.ssh</code> 目录中生两个密钥文件，<code>id_ecdsa</code> 为私钥，<code>id_ecdsa.pub</code> 为公钥。公钥就是我们需要安装在远程主机上的。</p>
<blockquote>
<blockquote>
<p>科普：~符号代表用户主目录，俗称家目录。其路径与当前登陆的用户有关，在 Linux 中普通用户家目录的路径是/home/用户名，而 root 用户是/root。Win­dows 10 中路径是C:\Users\用户名。在 ma­cOS 中路径是/Users/用户名。</p>
</blockquote>
</blockquote>
<h4 id="安装公钥">安装公钥</h4>
<h5 id="从-github-获取公钥">从 GitHub 获取公钥</h5>
<p>在 GitHub 密钥管理页面 添加公钥，比如我的用户名是 P3TERX，那么在主机上输入以下命令即可：</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -g P3TERX</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="从-url-获取公钥">从 URL 获取公钥</h5>
<p>把公钥上传到网盘，通过网盘链接获取公钥：</p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -u https://p3terx.com/key.pub</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="从本地文件获取公钥">从本地文件获取公钥</h5>
<p>通过 FTP 的方式把公钥传到 VPS 上，然后指定公钥路径：</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -f ~/key.pub</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="覆盖模式">覆盖模式</h4>
<p>使用覆盖模式（-o）将覆盖 /.ssh/authorized_keys 文件，之前的密钥会被完全替换掉，选项必须写在最前面才会生效，比如：</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -o -g P3TERX</span></span></code></pre></td></tr></table>
</div>
</div><p>或者</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -og P3TERX</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="禁用密码登录">禁用密码登录</h4>
<p>在确定使用密钥能正常登录后禁用密码登录：</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -d</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="修改-ssh-端口">修改 SSH 端口</h4>
<p>把 SSH 端口修改为 2222：</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -p <span class="m">2222</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="一键操作">一键操作</h4>
<p>安装密钥、修改端口、禁用密码登录一键操作：</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/key.sh<span class="o">)</span> -og P3TERX -p <span class="m">2222</span> -d</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>宝塔面板安装Tiny Tiny RSS</title><link>https://blog.iqzhi.com/posts/bt-install-tt-rss/</link><pubDate>Fri, 27 Oct 2023 15:28:18 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/bt-install-tt-rss/</guid><description><![CDATA[<p>物尽其用，刚好雨云免费的宝塔面板可以绑定两个域名，一个用作博客备站，另一个刚好可以玩下Tiny Tiny RSS。</p>
<p>官网最新教程已然推荐使用docker进行安装了，但雨云的虚拟主机无法安装docker，只能使用源码安装，好在基础环境宝塔面板还是简化了些操作，但是由于多年更新，此种安装方式官方wiki也不再更新，导致还是碰上了很多坑，一路坑一路填，居然成功了。</p>
<h2 id="宝塔面板新建站点">宝塔面板新建站点</h2>
<ol>
<li>
<p>面站 -&gt; PHP项目 -&gt; 添加站点，确定文件目录，选用PHP7.4版本</p>
</li>
<li>
<p>软件商店 -&gt; PHP-7.4 -&gt; 安装扩展<code>fileinfo</code></p>
</li>
</ol>
<h2 id="tiny-tiny-rss">Tiny Tiny RSS</h2>
<p><a href="https://tt-rss.org/wiki.php"target="_blank" rel="external nofollow noopener noreferrer">wiki</a></p>
<ol>
<li>按<a href="https://tt-rss.org/wiki/InstallationNotesHost"target="_blank" rel="external nofollow noopener noreferrer">教程</a>，先下载源码。</li>
</ol>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://git.tt-rss.org/fox/tt-rss.git tt-rss</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>配置<code>config.php</code></li>
</ol>
<p>网上某些教程说可以访问<code>/install</code>路径进行数据库配置安装，但访问后报了404，那些教程已然落后了。</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp config.php-dist config.php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 追加</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_TYPE=mysql&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_PORT=3306&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_HOST=dbhost&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_NAME=dbname&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_USER=dbuser&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_DB_PASS=dbpassword&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">putenv<span class="o">(</span><span class="s1">&#39;TTRSS_SELF_URL_PATH=https://example.com/tt-rss&#39;</span><span class="o">)</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>安装数据库</li>
</ol>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">php ./update.php --update-schema</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>理论上，做完这些，你就可以在相应网址看到Tiny Tiny RSS首页了。</li>
</ol>
<p>but，WTF！！！</p>
<p>我遇到了下列一系列的坑。</p>
<h2 id="踩坑过程">踩坑过程</h2>
<h3 id="坑一php多版本共存">坑一：PHP多版本共存</h3>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>宝塔面板有两个版本的PHP，默认是更高的8以上版本，可能不支持！<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">PHP Fatal error:  Uncaught Error: Call to undefined function putenv() in /www/wwwroot/rss.izhi.tk/config.php:3
</span></span><span class="line"><span class="cl">Stack trace:
</span></span><span class="line"><span class="cl">#0 /www/wwwroot/rss.izhi.tk/include/functions.php(29): require_once()
</span></span><span class="line"><span class="cl">#1 /www/wwwroot/rss.izhi.tk/update.php(11): require_once(&#39;...&#39;)
</span></span><span class="line"><span class="cl">#2 {main}
</span></span><span class="line"><span class="cl">  thrown in /www/wwwroot/rss.izhi.tk/config.php on line 3</span></span></code></pre></td></tr></table>
</div>
</div><p>指定php命令版本</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/www/server/php/74/bin/php ./update.php --update-schema</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<h3 id="坑二函数-putenv-过期">坑二：函数 <code>putenv</code> 过期</h3>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>Exception while creating PDO object:could not find driver<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">PHP Warning:  putenv() has been disabled for security reasons in /www/wwwroot/xxx.tk/config.php on line 3</span></span></code></pre></td></tr></table>
</div>
</div><p>从日志可以看出，配置方式过时了，未生效，tt-rss使用了默认的PostgreSQL数据库，由于PHP未安装pgsql扩展而报未找到驱动错误。</p>
<p>两种处理方式，我使用1可以解决，第2种后边在网上找到，未验证：</p>
<ol>
<li>直接在<code>classes/Confing.php</code>中配置默认值</li>
</ol>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">private</span> <span class="k">const</span> <span class="no">_DEFAULTS</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_TYPE</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;pgsql&#34;</span><span class="p">,</span>                                                                   <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_HOST</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;db&#34;</span><span class="p">,</span>                                                                              <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_USER</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>                                                                                        <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_NAME</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>                                                                                        <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_PASS</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>                                                                                        <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">DB_PORT</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;5432&#34;</span><span class="p">,</span>                                                                            <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">MYSQL_CHARSET</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;UTF8&#34;</span><span class="p">,</span>                                                              <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">SELF_URL_PATH</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;https://example.com/tt-rss&#34;</span><span class="p">,</span> <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">SINGLE_USER_MODE</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>                                                               <span class="nx">Config</span><span class="o">::</span><span class="na">T_BOOL</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">SIMPLE_UPDATE_MODE</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>                                                             <span class="nx">Config</span><span class="o">::</span><span class="na">T_BOOL</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">PHP_EXECUTABLE</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;/usr/bin/php&#34;</span><span class="p">,</span>                                     <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Config</span><span class="o">::</span><span class="na">LOCK_DIRECTORY</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s2">&#34;lock&#34;</span><span class="p">,</span>                                                             <span class="nx">Config</span><span class="o">::</span><span class="na">T_STRING</span> <span class="p">],</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>去掉禁用函数<code>putenv()</code> ,改用<code>define()</code>定义,详见<a href="https://community.tt-rss.org/t/error-pdo-object-sqlstate-08006-7-could-not-connect-to-server/4369"target="_blank" rel="external nofollow noopener noreferrer">Error: PDO object:SQLSTATE[08006] [7] could not connect to server</a></li>
</ol>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// *******************************************
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// *** Database configuration (important!) ***
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// *******************************************
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_TYPE&#39;</span><span class="p">,</span> <span class="s2">&#34;pgsql&#34;</span><span class="p">);</span> <span class="c1">// or mysql
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">,</span> <span class="s2">&#34;localhost&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_USER&#39;</span><span class="p">,</span> <span class="s2">&#34;fox&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_NAME&#39;</span><span class="p">,</span> <span class="s2">&#34;fox&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_PASS&#39;</span><span class="p">,</span> <span class="s2">&#34;XXXXXX&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;DB_PORT&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// usually 5432 for PostgreSQL, 3306 for MySQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;MYSQL_CHARSET&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF8&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Connection charset for MySQL. If you have a legacy database and/or experience
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// garbage unicode characters with this option, try setting it to a blank string.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="c1">// ***********************************
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// *** Basic settings (important!) ***
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// ***********************************
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;SELF_URL_PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;https://example.org/tt-rss/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// This should be set to a fully qualified URL used to access
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// your tt-rss instance over the net.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// The value should be a constant string literal. Please don&#39;t use
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// PHP server variables here - you might introduce security
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// issues on your install and cause hard to debug problems.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// If your tt-rss instance is behind a reverse proxy, use the external URL.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;SINGLE_USER_MODE&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Operate in single user mode, disables all functionality related to
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// multiple users and authentication. Enabling this assumes you have
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// your tt-rss directory protected by other means (e.g. http auth).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">define</span><span class="p">(</span><span class="s1">&#39;SIMPLE_UPDATE_MODE&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Enables fallback update mode where tt-rss tries to update feeds in
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// background while tt-rss is open in your browser.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// If you don&#39;t have a lot of feeds and don&#39;t want to or can&#39;t run
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// background processes while not running tt-rss, this method is generally
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// viable to keep your feeds up to date.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// Still, there are more robust (and recommended) updating methods
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// available, you can read about them here: http://tt-rss.org/wiki/UpdatingFeeds
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="nx">blah</span><span class="p">,</span> <span class="nx">etc</span><span class="p">,</span> <span class="nx">blah</span><span class="o">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>
<h3 id="坑三非root用户运行">坑三：非root用户运行</h3>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i><ul>
<li>Please don&rsquo;t run this script as root.</li>
</ul>
<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>不能使用root运行，通过<code>su</code>切换指定<code>www</code>用户运行。</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u www /www/server/php/74/bin/php ./update.php --update-schema</span></span></code></pre></td></tr></table>
</div>
</div><p>以下<a href="https://community.tt-rss.org/t/cannot-run-update-php-by-any-means/2516/2"target="_blank" rel="external nofollow noopener noreferrer">备用</a></p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo -u www-data php ./update.php --daemon</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>]]></description></item><item><title>使用github的webhook自动触发宝塔部署的hugo博客更新</title><link>https://blog.iqzhi.com/posts/github-webhook-bt-hugo/</link><pubDate>Tue, 24 Oct 2023 16:21:21 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/github-webhook-bt-hugo/</guid><description><![CDATA[<p>博客部署到vercel上，有时终究是会遇到网络抽风，听说雨云线路还不错，也有免费用度，于是搞了台雨云的香港宝塔面板，研究如何可以达到像vercel上的自动部署效果。</p>
<h2 id="解决方案">解决方案</h2>
<p>本地提交 hugo 源码到 Github，自动触发构建并同步到宝塔指定的网站目录。</p>
<h3 id="github自动构建">Github自动构建</h3>
<p>在 Github 的 Hugo 源码仓库根目录，新建&quot;.github/workflows/xxx.yml 文件，复制以下代码。作用：借助 Github Action 实现自动构建，并同步到另外一个仓库。其中 <code>PERSONAL_TOKEN</code> 为另外仓库的访问密钥；<code>external_repository</code> 为另外仓库地址。</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Githubblog</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">push</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">main</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">jobs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l">ubuntu-latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">actions/checkout@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">submodules</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Setup Hugo</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-hugo@v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">hugo-version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;latest&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">extended</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">hugo --minify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Deploy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">peaceiris/actions-gh-pages@v3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">personal_token</span><span class="p">:</span><span class="w"> </span><span class="l">${{ secrets.PERSONAL_TOKEN }}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">external_repository</span><span class="p">:</span><span class="w"> </span><span class="l">koobai/koobai.github.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">publish_dir</span><span class="p">:</span><span class="w"> </span><span class="l">./public</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="宝塔面板终端生成-git-公钥">宝塔面板终端生成 git 公钥</h3>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Git全局配置和单个仓库的用户名邮箱配置</span>
</span></span><span class="line"><span class="cl">git config --global user.name  <span class="s2">&#34;username&#34;</span>
</span></span><span class="line"><span class="cl">git config --global user.email  <span class="s2">&#34;your@email.com&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 生成git公钥用于自动拉取</span>
</span></span><span class="line"><span class="cl">ssh-keygen -t rsa -C <span class="s2">&#34;你的@email.com&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 查看git公钥</span>
</span></span><span class="line"><span class="cl">cat ~/.ssh/id_rsa.pub</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="添加公钥到到-github">添加公钥到到 Github</h3>
<p>头像–Settings–SSH and GPG keys–New SSH key</p>
<h3 id="宝塔面板安装-webhook-触发同步">宝塔面板安装 WebHook 触发同步</h3>
<p>打开宝塔面板商店，安装 WebHook 插件–添加执行脚本 (复制以下代码)。其中&quot;gitHttp 为需同步的 github 仓库地址&quot;，“gh-pages&quot;为仓库分支名称。</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">echo</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#输出当前时间</span>
</span></span><span class="line"><span class="cl">date --date<span class="o">=</span><span class="s1">&#39;0 days ago&#39;</span> <span class="s2">&#34;+%Y-%m-%d %H:%M:%S&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Start&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#git分支名称</span>
</span></span><span class="line"><span class="cl"><span class="nv">branch</span><span class="o">=</span><span class="s2">&#34;gh-pages&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#git项目路径</span>
</span></span><span class="line"><span class="cl"><span class="nv">gitPath</span><span class="o">=</span><span class="s2">&#34;/www/wwwroot/</span><span class="nv">$1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#git 仓库地址</span>
</span></span><span class="line"><span class="cl"><span class="nv">gitHttp</span><span class="o">=</span><span class="s2">&#34;git@github.com:yourname/yourname.github.io.git&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Web站点路径：</span><span class="nv">$gitPath</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#判断项目路径是否存在</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -d <span class="s2">&#34;</span><span class="nv">$gitPath</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nb">cd</span> <span class="nv">$gitPath</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#判断是否存在git目录</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&#34;.git&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;在该目录下克隆 git&#34;</span>
</span></span><span class="line"><span class="cl">                sudo git clone <span class="nv">$gitHttp</span> gittemp
</span></span><span class="line"><span class="cl">                sudo mv gittemp/.git .
</span></span><span class="line"><span class="cl">                sudo rm -rf gittemp
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;拉取最新的项目文件&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#sudo git reset --hard origin/$branch</span>
</span></span><span class="line"><span class="cl">        git remote add origin <span class="nv">$gitHttp</span>
</span></span><span class="line"><span class="cl">        git branch --set-upstream-to<span class="o">=</span>origin/<span class="nv">$branch</span> <span class="nv">$branch</span>
</span></span><span class="line"><span class="cl">        sudo git reset --hard origin/<span class="nv">$branch</span>
</span></span><span class="line"><span class="cl">        sudo git pull <span class="nv">$gitHttp</span>  2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;设置目录权限&#34;</span>
</span></span><span class="line"><span class="cl">        sudo chown -R www:www <span class="nv">$gitPath</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;End&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;该项目路径不存在&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;新建项目目录&#34;</span>
</span></span><span class="line"><span class="cl">        mkdir <span class="nv">$gitPath</span>
</span></span><span class="line"><span class="cl">        <span class="nb">cd</span> <span class="nv">$gitPath</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#判断是否存在git目录</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&#34;.git&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;在该目录下克隆 git&#34;</span>
</span></span><span class="line"><span class="cl">                sudo git clone <span class="nv">$gitHttp</span> gittemp
</span></span><span class="line"><span class="cl">                sudo mv gittemp/.git .
</span></span><span class="line"><span class="cl">                sudo rm -rf gittemp
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;拉取最新的项目文件&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#sudo git reset --hard origin/$branch</span>
</span></span><span class="line"><span class="cl">        sudo git pull gitHttp 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;设置目录权限&#34;</span>
</span></span><span class="line"><span class="cl">        sudo chown -R www:www <span class="nv">$gitPath</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;End&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="github-网页仓库配置-webhook">Github 网页仓库配置 WebHook</h3>
<p>查看 WebHook 插件密钥，复制密钥地址。添加到 Github 需同步的仓库–Settings–Webhooks–Add webhook。其中 Content type 选择 application/json。</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">格式如：https://面板地址:面板端口/hook?access_key=密钥&amp;param=需同步到的目录名称</span></span></code></pre></td></tr></table>
</div>
</div><p>至此，步骤全部完成。当本地提交新文件到 Github hugo 源码 main 分支，就会自动触发（hugo 生成静态文件——同步到另一个仓库——同步到宝塔网站指定目录）。如果域名指定境外访问路径是 vercel 或 cloudflare 服务，当 hugo 源码更新的时候也会自动触发构建更新。</p>
<h2 id="参考">参考</h2>
<p><a href="https://koobai.com/hugo_action_webhooks/"target="_blank" rel="external nofollow noopener noreferrer">Github 自动构建 Hugo, 并通过 Webhook 同步到宝塔指定目录</a>
<a href="https://github.com/peaceiris/actions-gh-pages"target="_blank" rel="external nofollow noopener noreferrer">GitHub Pages Action</a></p>]]></description></item><item><title>UFW 防火墙使用备忘</title><link>https://blog.iqzhi.com/posts/use-ufw/</link><pubDate>Wed, 18 Oct 2023 17:29:31 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/use-ufw/</guid><description><![CDATA[<p>防火墙用于监控过滤传入和传出网络流量，可以定义一组规则用来放行或者组织特定流量。</p>
<p>很多大厂自带防火墙相当强力，但是对于大部分IDC商而言，并没有提供相应的面板，如果想要达到阻断某些流量的效果就需要自行安装并配置。比如22(ssh) 端口只允许特定IP登录。</p>
<p>Debian10 附赠UFW防火墙配置工具，用于管理iptables，不过更加友好，简单，易使用。</p>
<p>本文介绍如何使用UFW在Debian 系统中配置和管理防火墙。文章只包含基础用法。</p>
<p>本文环境：Debian11 默认root 权限</p>
<h2 id="使用ufw">使用UFW</h2>
<h3 id="安装ufw">安装UFW</h3>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update
</span></span><span class="line"><span class="cl">apt install ufw</span></span></code></pre></td></tr></table>
</div>
</div><p>安装完成后可以使用 <code>ufw status verbose</code> 查看当前状态</p>
<h3 id="ufw默认策略">UFW默认策略</h3>
<p>ufw防火墙默认阻止所有传入和转发流量，允许所有出站流量。这就意味着除非打开专门的ssh端口，否则所有访问服务器的流量，包括你自己都无法连接。</p>
<h3 id="应用配置文件">应用配置文件</h3>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 查看软件安装包</span>
</span></span><span class="line"><span class="cl">ufw app list
</span></span><span class="line"><span class="cl"><span class="c1"># 查看相应配置文件</span>
</span></span><span class="line"><span class="cl">ufw app info <span class="s1">&#39;SSH&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="开启ufw">开启UFW</h3>
<p>一定注意，使用UFW第一项就要开启你相应的ssh 端口，<strong>否则下次将无法登录！</strong></p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 按照默认配置开启tcp 22端口</span>
</span></span><span class="line"><span class="cl">ufw allow ssh
</span></span><span class="line"><span class="cl"><span class="c1"># 如果改变了ssh 端口，如33</span>
</span></span><span class="line"><span class="cl">ufw allow 33/tcp
</span></span><span class="line"><span class="cl"><span class="c1"># 开启ufw</span>
</span></span><span class="line"><span class="cl">ufw enable</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="通用规则">通用规则</h2>
<p>通过上文的开启ssh 端口并启用UFW，其实已经可以看出一般规则</p>
<h3 id="增加规则">增加规则</h3>
<ul>
<li>开启指定端口</li>
</ul>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 端口以999为例</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 指定端口协议</span>
</span></span><span class="line"><span class="cl">ufw allow port/protoc
</span></span><span class="line"><span class="cl"><span class="c1"># 指定端口，不指定协议，将同时允许tcp，udp</span>
</span></span><span class="line"><span class="cl">ufw allow port
</span></span><span class="line"><span class="cl"><span class="c1"># 如开启999端口的udp 协议</span>
</span></span><span class="line"><span class="cl">ufw allow 999/udp</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>开启指定范围端口</li>
</ul>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 开启80，440端口</span>
</span></span><span class="line"><span class="cl">ufw allow 80,443/tcp
</span></span><span class="line"><span class="cl"><span class="c1"># 开启888-999的tcp 协议端口</span>
</span></span><span class="line"><span class="cl">ufw allow 888:999/tcp</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>指定IP访问端口</li>
</ul>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># IP 66.66.66.66 可以访问连接所有服务器端口</span>
</span></span><span class="line"><span class="cl">ufw allow from 66.66.66.66
</span></span><span class="line"><span class="cl"><span class="c1"># 只有IP 66.66.66.66 可以访问22端口进行ssh连接</span>
</span></span><span class="line"><span class="cl">ufw allow from 66.66.66.66 to any port <span class="m">22</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>子网/ip段 访问端口</li>
</ul>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 192.168.1.1 - 192.168.1.254 可以访问3306 端口</span>
</span></span><span class="line"><span class="cl">ufw allow from 192.168.1.0/24 to any port <span class="m">3306</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>拒绝访问</li>
</ul>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 只需将allow 改为deny 即可</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 如拒绝1.2.3.4 访问网页</span>
</span></span><span class="line"><span class="cl">ufw deny from 1.2.3.4 to any port 80,443</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>通过服务开启端口</li>
</ul>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 使用服务名称，如http</span>
</span></span><span class="line"><span class="cl">ufw allow http
</span></span><span class="line"><span class="cl"><span class="c1"># 指定协议端口</span>
</span></span><span class="line"><span class="cl">ufw allow 80/tcp
</span></span><span class="line"><span class="cl"><span class="c1"># 如安装了Nginx可使用</span>
</span></span><span class="line"><span class="cl">ufw allow <span class="s1">&#39;Nginx HTTP&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="查看当前已添加规则">查看当前已添加规则</h3>
<p>使用 <code>ufw status numbered</code></p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@gogo:~# ufw status numbered
</span></span><span class="line"><span class="cl">Status: active
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">     To                         Action      From
</span></span><span class="line"><span class="cl">     --                         ------      ----
</span></span><span class="line"><span class="cl"><span class="o">[</span> 1<span class="o">]</span> 668/tcp                    ALLOW IN    Anywhere                  
</span></span><span class="line"><span class="cl"><span class="o">[</span> 2<span class="o">]</span> 80/tcp                     ALLOW IN    Anywhere                  
</span></span><span class="line"><span class="cl"><span class="o">[</span> 3<span class="o">]</span> 668/tcp <span class="o">(</span>v6<span class="o">)</span>               ALLOW IN    Anywhere <span class="o">(</span>v6<span class="o">)</span>             
</span></span><span class="line"><span class="cl"><span class="o">[</span> 4<span class="o">]</span> 80/tcp <span class="o">(</span>v6<span class="o">)</span>                ALLOW IN    Anywhere <span class="o">(</span>v6<span class="o">)</span>   </span></span></code></pre></td></tr></table>
</div>
</div><h3 id="删除规则">删除规则</h3>
<ul>
<li>使用编号删除</li>
</ul>
<p><code>ufw delete id</code></p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@gogo:~# ufw delete <span class="m">2</span>
</span></span><span class="line"><span class="cl">Deleting:
</span></span><span class="line"><span class="cl"> allow 80/tcp
</span></span><span class="line"><span class="cl">Proceed with operation <span class="o">(</span>y<span class="p">|</span>n<span class="o">)</span>? y
</span></span><span class="line"><span class="cl">Rule deleted</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>使用端口删除</li>
</ul>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 删除端口访问</span>
</span></span><span class="line"><span class="cl">ufw delete allow 80/tcp</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="设置-ufw-状态">设置 UFW 状态</h3>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 禁用ufw</span>
</span></span><span class="line"><span class="cl">ufw disable
</span></span><span class="line"><span class="cl"><span class="c1"># 启用ufw</span>
</span></span><span class="line"><span class="cl">ufw enable</span></span></code></pre></td></tr></table>
</div>
</div><p>下一条命令为危险命令，将会<strong>删除所有活动规则</strong>，谨慎使用</p>
<p><code>ufw reset</code></p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@gogo:~# ufw reset
</span></span><span class="line"><span class="cl">Resetting all rules to installed defaults. This may disrupt existing ssh
</span></span><span class="line"><span class="cl">connections. Proceed with operation <span class="o">(</span>y<span class="p">|</span>n<span class="o">)</span>? </span></span></code></pre></td></tr></table>
</div>
</div><h2 id="问题解决">问题解决</h2>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>Docker 在UFW中的网络处理<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>安装了Docker后，涉及Docker网络放通存在变化，可以查以下资料适配。</p>
<p><a href="https://github.com/chaifeng/ufw-docker#%E8%A7%A3%E5%86%B3-ufw-%E5%92%8C-docker-%E7%9A%84%E9%97%AE%E9%A2%98"target="_blank" rel="external nofollow noopener noreferrer">解决-ufw-和-docker-的问题</a></p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#命令备忘</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#按container_name管理</span>
</span></span><span class="line"><span class="cl">ufw-docker allow nginx-proxy-manager
</span></span><span class="line"><span class="cl">ufw-docker allow nginx-proxy-manager 443/tcp
</span></span><span class="line"><span class="cl">ufw-docker delete allow nginx-proxy-manager
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#放通docker容器内部</span>
</span></span><span class="line"><span class="cl">ufw allow from 172.16.0.0/12 to any
</span></span><span class="line"><span class="cl"><span class="c1">#放通zerotier</span>
</span></span><span class="line"><span class="cl">ufw allow from 10.147.x.0/24 to any
</span></span><span class="line"><span class="cl"><span class="c1">#放通本地</span>
</span></span><span class="line"><span class="cl">ufw allow from 192.168.x.0/24 to any</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>]]></description></item><item><title>Nginx学习笔记</title><link>https://blog.iqzhi.com/posts/nginx-study/</link><pubDate>Sat, 07 Oct 2023 14:55:39 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/nginx-study/</guid><description><![CDATA[<p>Nginx的用法、配置及问题解决。</p>
<h2 id="nginx-配置-http-请求重定向到-https">nginx 配置 http 请求重定向到 https</h2>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">server {
</span></span><span class="line"><span class="cl">    listen 80;
</span></span><span class="line"><span class="cl">    server_name aaa.abc.dd;
</span></span><span class="line"><span class="cl">    rewrite ^(.*)$ https://${server_name}$1 permanent;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div><p>这样就可以 <a href="http://aaa.abc.dd"target="_blank" rel="external nofollow noopener noreferrer">http://aaa.abc.dd</a> 转到 <a href="https://aaa.abc.dd"target="_blank" rel="external nofollow noopener noreferrer">https://aaa.abc.dd</a> 了。</p>
<h2 id="nginx防止被域名恶意解析的配置">Nginx防止被域名恶意解析的配置</h2>
<p>nginx在决定请求由哪个server块执行时，主要关注的是server块中的listen和server_name两个字段，如果根据listen指令无法得到最佳匹配，将会开始解析server_name指令。nginx会检查请求中的&quot;Host&quot;头，这个值包含了客户端实际试图请求的域名或者ip地址。nginx会根据这个值去匹配server_name指令，匹配规则会在文章中详细描述。其中有一个需要大家注意的地方是如果没有匹配到任何规则的话，则会选择可用列表中的第一个server，带来的问题就是未绑定域名或IP直接访问80和443端口会给后端逻辑服务增加压力并产生不合理的错误日志，合适的解决办法是通过在nginx的server块中添加default_server禁止未绑定域名或IP访问80和443端口过滤不合理的流量。</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">server {
</span></span><span class="line"><span class="cl">    server_name _;
</span></span><span class="line"><span class="cl">    listen 80 default_server;
</span></span><span class="line"><span class="cl">    listen 443 ssl default_server;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ## To also support IPv6, uncomment this block
</span></span><span class="line"><span class="cl">    # listen [::]:80 default_server;
</span></span><span class="line"><span class="cl">    # listen [::]:443 ssl default_server;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ssl_certificate &lt;path to cert&gt;;
</span></span><span class="line"><span class="cl">    ssl_certificate_key &lt;path to key&gt;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return 444;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    access_log /var/log/nginx/000_default.access.log;
</span></span><span class="line"><span class="cl">    error_log /var/log/nginx/000_default.error.log;
</span></span><span class="line"><span class="cl">}</span></span></code></pre></td></tr></table>
</div>
</div><p>这样在浏览器端访问的时候，浏览器会自动提示用户无法访问。</p>
<h2 id="server_name指令">Server_name指令</h2>
<p>如果根据listen指令无法得到最佳匹配,将会开始解析server_name指令.nginx会检查请求中的&quot;Host&quot;头,这个值包含了客户端实际试图请求的域名或者ip地址.nginx会根据这个值去匹配server_name指令,匹配规则如下:</p>
<p>nginx会尝试寻找一个和sever_name和Host值完全匹配的server块,如果找到多个精确匹配,则会使用第一个匹配的server块
如果没有找到精确匹配的server块,则nginx尝试找到server_name带有<em>开头的server块,如果找到多个,则选择最长匹配的server块
如果没有找到使用开头的server块,则会寻找以结尾的server块,同样,如果有多个匹配, 选择最长匹配
如果没有找到使用</em>匹配的server块,则会寻找使用正则表达式(以~开头)定义server_name的server块,如果找到多个匹配,会使用第一个匹配
如果没有找到正则表达式匹配的server块,则nginx将会选择一个匹配listen字段的default server块.每一个ip和端口组合都可以配置一个且只能配置一个默认的default_server块,如果没有的话,则会选择可用列表中的第一个server</p>
<h2 id="常用命令">常用命令</h2>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># reload nginx</span>
</span></span><span class="line"><span class="cl">nginx -t
</span></span><span class="line"><span class="cl">nginx -s reload</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>OpenWrt + OpenClash + AdGuard Home 打造家庭专用网络</title><link>https://blog.iqzhi.com/posts/openwrt-openclash-adguard-home/</link><pubDate>Mon, 11 Sep 2023 09:56:12 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/openwrt-openclash-adguard-home/</guid><description><![CDATA[<p>搞了个低功耗小玩具N5105，做软路由刚刚好。</p>
<h2 id="总体方案">总体方案</h2>
<p>家庭网络，要使用顺手，我认为要符合以下几点：</p>
<ol>
<li>光猫只桥接信号，主路由负责拨号，摆脱光猫弱鸡性能，保证并发量及持续稳定。</li>
<li>旁路由负责科学上网、VPN、DNS防污染、广告过滤等，功能只覆盖专用网络内部使用，影响面可控，保障就算旁路由宕机，也不影响大众群体网络正常访问。</li>
<li>NAS可根据储存数据的重要性分情况考虑，更建议独立机器部署，以免磁盘共用使得物理读写频繁损耗加剧，从而影响导致整体性能。</li>
</ol>
<h2 id="主路由规划">主路由规划</h2>
<p>为达到以上要求，方案自然就出来了。</p>
<ol>
<li>主路由通过 DHCP 规划网段，以一个C段（192.168.3.0/24）为例，可分网段管理：
<ul>
<li>主路由设置内网IP（192.168.3.1），DNS自动获取或手动设置均可；</li>
<li>旁路由设置静态IP（192.168.3.2），GW（192.168.3.1），DNS（223.5.5.5）；</li>
<li>正常接入网络自动获取，IP（192.168.3.101 - 192.168.3.200），GW（192.168.3.1），DNS（223.5.5.5、119.29.29.29）；</li>
<li>对家庭成员常用设备手工静态分配，IP（192.168.3.41 - 192.168.3.80），GW（192.168.3.1），DNS（223.5.5.5、119.29.29.29）；</li>
<li>个人专用网络静态分配，IP（192.168.3.91 - 192.168.3.100），GW（192.168.3.2），DNS（192.168.3.2、223.5.5.5）；</li>
<li>剩余地址按需分配使用。</li>
</ul>
</li>
</ol>
<h2 id="旁路由配置">旁路由配置</h2>
<p>最终方案：客户端→AdGuard Home(53)→OpenClash(7874)</p>
<div class="details admonition tip open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden="true"></i>配置思路<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><ol>
<li>客户端→Dnsmasq(53)→Clash(7874)→AdGuard Home(5335)</li>
<li>客户端→Dnsmasq(53)→AdGuard Home(5335)→OpenClash(7874)</li>
<li>客户端→AdGuard Home(53)→OpenClash(7874)</li>
</ol>
<p>按思路1，在OpenClash里开启DNS劫持，让Dnsmasq把请求转发到OpenClash，然后在OpenClash里设置自定义上游DNS，把底下所有的上游DNS勾选都去掉，新建一个FallBack从AdGuard Home里获取结果；配置虽然成功了，但广告去除效果不好，根因是要屏蔽广告的地址经过OpenClash时就被代理出去了，所以不会向上游AdGuard Home去请求解析，而且AdGuard Home里客户端只能看见127.0.0.1这一条，也不够完美，所以这方案放弃；随后尝试方案2，AdGuard Home里的客户端也都能正常显示了，发现前面多了Dnsmasq似乎多余了，因为它只负责转发，所以衍生出方案3，但有个缺点，因为Dnsmasq和DHCP功能是在一起的，跳过了Dnsmasq则DHCP也不能用了，解决方案就是禁用旁路由DHCP功能，去lan接口里设置忽略此接口(不在此接口提供DHCP服务)，完美。</div>
    </div>
  </div>
<h3 id="安装openwrt系统">安装OpenWrt系统</h3>
<ul>
<li>网络-接口-Lan，底下基本设置勾选 「忽略此接口」</li>
<li>网络-DHCP/DNS-高级设置，把DNS服务器端口由53改为其他，比如5335，主要不要端口冲突，保存生效</li>
</ul>
<h3 id="openclash科学上网">OpenClash科学上网</h3>
<ul>
<li>服务-OpenClash-全局设置-DNS设置，去掉本地DNS持，勾选自定义上游DNS服务器，然后在下面自定义DNS里看够不够，有更好的DNS也可以加上去，勾选远程域名解析，应用配置</li>
</ul>
<h3 id="adguard-home广告过滤">AdGuard Home广告过滤</h3>
<ul>
<li>
<p>服务-AdGuard Home，点更新核心，点启用，重定向选择「无」，点手动设置，按如下修改，改完保存&amp;应用</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">bind_host</span><span class="p">:</span><span class="w"> </span><span class="m">0.0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">bind_port</span><span class="p">:</span><span class="w"> </span><span class="m">3003</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">dns</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">bind_hosts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="m">0.0.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">53</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upstream_dns</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="m">127.0.0.1</span><span class="p">:</span><span class="m">7874</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置结束，点击AdGuard Home里AdGuardHome Web:3003，可以打开ADG的管理界面，点击「过滤器-&gt;DNS封锁清单」，去网上找一些大神维护的ADG的去广告规则，加进去。</p>
</li>
</ul>]]></description></item><item><title>从Hexo迁移到Hugo</title><link>https://blog.iqzhi.com/posts/migrate-from-hexo-to-hugo/</link><pubDate>Sun, 10 Sep 2023 10:44:21 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/migrate-from-hexo-to-hugo/</guid><description><![CDATA[<p>无意网上看到大神使用Hugo建立的Blog，升起了自建的念头。</p>
<h2 id="为什么要迁移">为什么要迁移</h2>
<ol>
<li>可能是一颗喜欢折腾的心。</li>
<li>评估原来Hexo博客的情况，迁移工作不难。</li>
<li>Hugo优势更吸引，独立二进制文件，简洁高效。</li>
<li>Blog原有的文章数不多，希望有个新的开始，是时候积累点，无论是否流水账。</li>
</ol>
<h2 id="对博客发展的顾虑或是考虑过多">对博客发展的顾虑，或是考虑过多</h2>
<ol>
<li>还是不喜欢为博客配图，这个无法从根本上改善博客的观感。也可能是未找到靠谱的图库解决方案。</li>
<li>总想着以后可能又不会继续书写下去，插入太多的图片，使用框架程序内特定的语法会影响后续迁移可能，带来的不确定性。</li>
<li>所以有点感觉是放不开手脚去做，畏手畏尾，从而什么都没有做。</li>
</ol>
<h2 id="迁移发现惊喜">迁移发现惊喜</h2>
<ol>
<li>原来的Hexo博客已经折腾出后台管理解决方案了，通过Qoex可解决，但因为部署在Vercel上，大陆访问有一定的卡顿。</li>
<li>由于Qoex也支持Hugo，本计划也使用其进行后台管理，但总有不得力的感觉，谈不上喜欢或讨厌，也没有书写的兴致。</li>
<li>最后我也找到了合适的解决方案，通过VS Code可以远程管理部署在Debian上的Hugo程序代码，也方便在工作环境中远程管理，完美。</li>
</ol>
<h2 id="网站建设思路">网站建设思路</h2>
<ol>
<li>通过ZeroTier建立虚拟局域网，把家庭环境、工作环境、外出场景打通。</li>
<li>Hugo程序部署在Debian服务器上，开放SSH访问远程管理，生成环境唯一部署，减少出错可能性。</li>
<li>利用VS Code插件Remote SSH连接Debian系统上的Hugo源码目录，撰写文章。</li>
<li>VS Code终端运行命令发布预览，自带端口转发部署，可实时调试页面展示。</li>
<li>VS Code直接源码提交Github管理，使用Vercel监控提交记录，实现实时生成部署。</li>
</ol>
<h2 id="问题解决">问题解决</h2>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>Github：通过sshkey的方式拉取代码报错kex_exchange_identification: Connection closed by remote<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>近来家庭网络进行了调整，增加了科学上网，应该是网络引发问题产生；网上查资料，通过编辑 <code>~/.ssh/config</code> 文件（没有就新增），在用户目录下的.ssh目录，添加如下内容解决：</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-md" data-lang="md"><span class="line"><span class="cl">Host github.com
</span></span><span class="line"><span class="cl">    HostName ssh.github.com
</span></span><span class="line"><span class="cl">    User git
</span></span><span class="line"><span class="cl">    Port 443</span></span></code></pre></td></tr></table>
</div>
</div></div>
    </div>
  </div>]]></description></item><item><title>Apline学习笔记</title><link>https://blog.iqzhi.com/posts/study-apline/</link><pubDate>Sun, 09 Apr 2023 23:11:58 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/study-apline/</guid><description><![CDATA[<p>CentOS离场，把玩debian。</p>
<h2 id="docker">Docker</h2>
<h3 id="开启远程管理">开启远程管理</h3>
<p>Alpine管理服务是用RC的组件，如果开启远程管理，需要修改 <code>/etc/init.d/docker</code>，在<code>command_args</code>参数后 增加：<code>-H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock</code>， 完整的文件如下：</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/sbin/openrc-run
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># Copyright 1999-2013 Gentoo Foundation</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Distributed under the terms of the GNU General Public License v2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">command</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKERD_BINARY</span><span class="k">:-</span><span class="p">/usr/bin/dockerd</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">pidfile</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_PIDFILE</span><span class="k">:-</span><span class="p">/run/</span><span class="si">${</span><span class="nv">RC_SVCNAME</span><span class="si">}</span><span class="p">.pid</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">command_args</span><span class="o">=</span><span class="s2">&#34;-p \&#34;</span><span class="si">${</span><span class="nv">pidfile</span><span class="si">}</span><span class="s2">\&#34; </span><span class="si">${</span><span class="nv">DOCKER_OPTS</span><span class="si">}</span><span class="s2"> -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">DOCKER_LOGFILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_LOGFILE</span><span class="k">:-</span><span class="p">/var/log/</span><span class="si">${</span><span class="nv">RC_SVCNAME</span><span class="si">}</span><span class="p">.log</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">DOCKER_ERRFILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_ERRFILE</span><span class="k">:-</span><span class="si">${</span><span class="nv">DOCKER_LOGFILE</span><span class="si">}}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">DOCKER_OUTFILE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_OUTFILE</span><span class="k">:-</span><span class="si">${</span><span class="nv">DOCKER_LOGFILE</span><span class="si">}}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">start_stop_daemon_args</span><span class="o">=</span><span class="s2">&#34;--background \
</span></span></span><span class="line"><span class="cl"><span class="s2">    --stderr \&#34;</span><span class="si">${</span><span class="nv">DOCKER_ERRFILE</span><span class="si">}</span><span class="s2">\&#34; --stdout \&#34;</span><span class="si">${</span><span class="nv">DOCKER_OUTFILE</span><span class="si">}</span><span class="s2">\&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">extra_started_commands</span><span class="o">=</span><span class="s2">&#34;reload&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">rc_ulimit</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_ULIMIT</span><span class="k">:-</span><span class="p">-c unlimited -n 1048576 -u unlimited</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">retry</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">DOCKER_RETRY</span><span class="k">:-</span><span class="nv">TERM</span><span class="p">/60/KILL/10</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">depend<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    need sysfs cgroups
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">start_pre<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    checkpath -f -m <span class="m">0644</span> -o root:docker <span class="s2">&#34;</span><span class="nv">$DOCKER_LOGFILE</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">reload<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        ebegin <span class="s2">&#34;Reloading </span><span class="si">${</span><span class="nv">RC_SVCNAME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        start-stop-daemon --signal HUP --pidfile <span class="s2">&#34;</span><span class="si">${</span><span class="nv">pidfile</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        eend <span class="nv">$?</span> <span class="s2">&#34;Failed to stop </span><span class="si">${</span><span class="nv">RC_SVCNAME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后重启 Docker 服务：</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service docker restart</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="挂载">挂载</h2>
<h3 id="cifs">cifs</h3>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 必要的依赖组件</span>
</span></span><span class="line"><span class="cl">apk add cifs-utils openrc
</span></span><span class="line"><span class="cl">sudo rc-update add netmount
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//192.168.9.23/Disk_sataa5 /mnt/zidoo cifs  _netdev,gid<span class="o">=</span>0,uid<span class="o">=</span>0,username<span class="o">=</span>guest,password<span class="o">=</span>guest,dynperm,exec,noacl,nobrl,nofail,nounix,rw,serverino,setuids,sfu <span class="m">0</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 在 /etc/fstab 文件末位增加一行，用于配置 SAMBA/SMB/CIFS 服务挂载项</span>
</span></span><span class="line"><span class="cl">//192.168.9.23/Disk_sataa5 /mnt/zidoo cifs  _netdev,credentials<span class="o">=</span>/root/.smb.auth,gid<span class="o">=</span>1000,uid<span class="o">=</span>1000,dynperm,exec,noacl,nobrl,nofail,nounix,rw,serverino,setuids,sfu <span class="m">0</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># credentials file content - 建议以下认证信息不要包含特殊符号，以免无法认证</span>
</span></span><span class="line"><span class="cl"><span class="c1"># /root/.smb.auth</span>
</span></span><span class="line"><span class="cl">cat &gt; /root/.smb.auth
</span></span><span class="line"><span class="cl"><span class="nv">username</span><span class="o">=</span>username
</span></span><span class="line"><span class="cl"><span class="nv">password</span><span class="o">=</span>password
</span></span><span class="line"><span class="cl"><span class="nv">domain</span><span class="o">=</span>doaminname
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> /root/.smb.auth
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 初次手动挂载(免重启)</span>
</span></span><span class="line"><span class="cl">mount -a</span></span></code></pre></td></tr></table>
</div>
</div><p>参考</p>
<ol>
<li><a href="https://www.cnblogs.com/alexyangchina/p/12973131.html"target="_blank" rel="external nofollow noopener noreferrer">Alpine Linux 中 Docker 开启远程管理</a></li>
<li><a href="https://blog.gazer.win/essay/cifs-netmount-on-alpine-linux.html"target="_blank" rel="external nofollow noopener noreferrer">SAMBA/SMB/CIFS 开机自动挂载 for Alpine Linux</a></li>
</ol>]]></description></item><item><title>Portainer - Docker可视化管理工具</title><link>https://blog.iqzhi.com/posts/portainer/</link><pubDate>Tue, 07 Mar 2023 17:00:19 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/portainer/</guid><description><![CDATA[<p>配置Docker可视化管理工具。</p>
<h2 id="连接远程和管理docker">连接远程和管理docker</h2>
<p>远程管理docke，端口默认是2375，是未加密的docker socket，远程root无密码访问主机</p>
<h3 id="开启配置">开启配置</h3>
<h4 id="方法一">方法一</h4>
<p>配置远程访问的API</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/default/docker
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">增加一行：
</span></span><span class="line"><span class="cl"><span class="nv">DOCKER_OPTS</span><span class="o">=</span><span class="s2">&#34;-H tcp://0.0.0.0:2375&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>PS：这是网上给的配置方法，也是这种简单配置让Docker Daemon把服务暴露在tcp的2375端口上，这样就可以在网络上操作Docker了。Docker本身没有身份认证的功能，只要网络上能访问到服务端口，就可以操作Docker。</p>
</blockquote>
<h4 id="方法二">方法二</h4>
<p>在/usr/lib/systemd/system/docker.service，配置远程访问。</p>
<p>主要是在<code>[Service]</code>这个部分，找到 ExecStart字段修改如下</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /usr/lib/systemd/system/docker.service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span>
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H fd:// --containerd<span class="o">=</span>/run/containerd/containerd.sock</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="方法三">方法三</h4>
<p>修改<code>daemon.json</code>的配置</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/docker/daemon.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;hosts&#34;</span>: <span class="o">[</span><span class="s2">&#34;tcp://0.0.0.0:2375&#34;</span>, <span class="s2">&#34;unix:///var/run/docker.sock&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="重启docker配置防火墙">重启docker，配置防火墙</h3>
<ol>
<li>重启docker重新读取配置文件，重新启动docker服务</li>
</ol>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl daemon-reload
</span></span><span class="line"><span class="cl">systemctl restart docker</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>开放防火墙端口</li>
</ol>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">firewall-cmd --zone<span class="o">=</span>public --add-port<span class="o">=</span>2375/tcp --permanent
</span></span><span class="line"><span class="cl"><span class="c1">#或</span>
</span></span><span class="line"><span class="cl">ufw allow from 192.168.9.0/24 to any</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>刷新防火墙</li>
</ol>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">firewall-cmd --reload
</span></span><span class="line"><span class="cl"><span class="c1">#或</span>
</span></span><span class="line"><span class="cl">systemctl restart ufw</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>如果重启起不来</li>
</ol>
<p>估计是这个 <code>unix://var/run/docker.sock</code> 文件位置不对，查找一下正确位置就好了。</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find / -name docker.sock</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>自装Debian系统折腾手记</title><link>https://blog.iqzhi.com/posts/debian-installation/</link><pubDate>Mon, 06 Mar 2023 09:47:38 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/debian-installation/</guid><description><![CDATA[<p>CentOS离场，把玩debian。</p>
<blockquote>
<p>适用版本：11（Bullseye）</p>
</blockquote>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@debian:~## uname -a
</span></span><span class="line"><span class="cl">Linux debian 5.10.0-21-amd64 <span class="c1">#1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="简言">简言</h2>
<p>说起为什么我要折腾Debian，还是因为CentOS不再更新了，在外新买的VPS也都使用了Debian系统，所以也想将目前的服务往Debian转移。</p>
<h2 id="安装">安装</h2>
<p>从官网下载ISO，加载启动即可。</p>
<p>Ps. 安装时root账号可设置空密码，这样就不能通过SSH登录了，必须另行设置新账号强密码即可。</p>
<p>可选清华的源，在安装过程中会将软件更至最新。</p>
<h3 id="时区">时区</h3>
<p>我们默认安装是已经正确设置时区，但是如果是第三方云主机时区就未必符合本地要求。</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## 查看时区，有 CST 正确</span>
</span></span><span class="line"><span class="cl">date
</span></span><span class="line"><span class="cl"><span class="c1">## 设置</span>
</span></span><span class="line"><span class="cl">sudo timedatectl set-timezone Asia/Shanghai
</span></span><span class="line"><span class="cl"><span class="c1">## 或者使用向导选择</span>
</span></span><span class="line"><span class="cl">tzselect</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ipv6">IPv6</h3>
<p>编辑interfaces文件<code>/etc/network/interfaces</code>，在文本最后面添加：</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">iface xxx inet6 dhcp</span></span></code></pre></td></tr></table>
</div>
</div><p>上面的xxx更换成接口名。</p>
<p>查看ipv6的网关：</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ip -6 route show</span></span></code></pre></td></tr></table>
</div>
</div><p>如果有：<strong>default via fe80::2e2:69ff:fe55:83a4 dev ens192 metric 1 pref medium</strong>，类似这样的出现，说明ipv6一切正常。否则需要手动编辑interfaces文件<code>/etc/network/interfaces</code>，在文本最后面添加：</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">up route -A inet6 add default gw fe80::2e2:69ff:fe55:83a4 dev ens192</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="zsh">zsh</h3>
<p>好用的zsh怎么少得了。</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 查看当前shell</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$SHELL</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 安装</span>
</span></span><span class="line"><span class="cl">apt install zsh
</span></span><span class="line"><span class="cl"><span class="c1"># 为 root 设置默认 shell</span>
</span></span><span class="line"><span class="cl">chsh -s /bin/zsh</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="全局配置-zsh">全局配置 zsh</h4>
<blockquote>
<p>注意：以下全局配置相关命令需要 root 权限，请切换到 root 账号，或者使用 sudo。</p>
</blockquote>
<p>全局安装 zsh 到 /etc 目录</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git clone --depth=1 https://github.com/ohmyzsh/ohmyzsh.git /etc/oh-my-zsh</span></span></code></pre></td></tr></table>
</div>
</div><p>从模板文件复制 .zshrc 创建默认配置文件（新用户将使用该配置文件）</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp /etc/oh-my-zsh/templates/zshrc.zsh-template /etc/skel/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><p>修改 on-my-zsh 的安装目录 <code>export ZSH=$HOME/.oh-my-zsh</code> 为 <code>export ZSH=/etc/oh-my-zsh</code></p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s|$HOME/.oh-my-zsh|/etc/oh-my-zsh|g&#39;</span> /etc/skel/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><p>为每个用户配置独立的 cache 目录</p>
<p>编辑 <code>/etc/skel/.zshrc</code> 在 <code>export ZSH=/etc/oh-my-zsh</code> 下添加一句：</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">ZSH_CACHE_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">XDG_CACHE_HOME</span><span class="k">:-</span><span class="nv">$HOME</span><span class="p">/.cache</span><span class="si">}</span><span class="s2">/oh-my-zsh&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>更改默认主题（推荐 ys）</p>
<p>编辑 /etc/skel/.zshrc 文件修改：</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;/^ZSH_THEME=.*/c ZSH_THEME=&#34;ys&#34;&#39;</span> /etc/skel/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><p>取消每周自动检查更新（新版不用管）</p>
<p>配置 ll 别名（可选）</p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;alias ll=&#34;ls -lahF --color --time-style=long-iso&#34;&#39;</span> &gt;&gt; /etc/skel/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="全局配置插件">全局配置插件</h4>
<p>全局安装插件（安装到 /etc/oh-my-zsh/custom/plugins/）</p>
<h5 id="zsh-syntax-highlightinghttpsgithubcomzsh-userszsh-syntax-highlighting语法高亮插件"><a href="https://github.com/zsh-users/zsh-syntax-highlighting"target="_blank" rel="external nofollow noopener noreferrer">zsh-syntax-highlighting</a>：语法高亮插件</h5>
<p>作用：命令错误会显示红色，直到你输入正确才会变绿色，另外路径正确会显示下划线。</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone --depth<span class="o">=</span><span class="m">1</span> https://github.com/zsh-users/zsh-syntax-highlighting.git /etc/oh-my-zsh/custom/plugins/zsh-syntax-highlighting</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="zsh-autosuggestionshttpsgithubcomzsh-userszsh-autosuggestions"><a href="https://github.com/zsh-users/zsh-autosuggestions"target="_blank" rel="external nofollow noopener noreferrer">zsh-autosuggestions</a></h5>
<p>作用：根据历史输入命令的记录即时的提示（建议补全），然后按 → 键即可补全。</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone --depth<span class="o">=</span><span class="m">1</span> https://github.com/zsh-users/zsh-autosuggestions.git /etc/oh-my-zsh/custom/plugins/zsh-autosuggestions</span></span></code></pre></td></tr></table>
</div>
</div><p>启用插件</p>
<p>编辑 <code>/etc/skel/.zshrc</code>，找到 plugins=(git) 这一行，修改为：</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">plugins</span><span class="o">=([</span>plugins...<span class="o">]</span>zsh-syntax-highlighting zsh-autosuggestions<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>快速修改：</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;/^plugins=.*/c plugins=(git zsh-syntax-highlighting zsh-autosuggestions)&#39;</span> /etc/skel/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="使用用户配置文件">使用用户配置文件</h4>
<p>改变新用户的默认 shell</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vi /etc/default/useradd</span></span></code></pre></td></tr></table>
</div>
</div><p>将 SHELL= * (比如 SHELL=/bin/sh) 改成 SHELL=/bin/zsh</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;/^SHELL=.*/c SHELL=/bin/zsh&#39;</span> /etc/default/useradd</span></span></code></pre></td></tr></table>
</div>
</div><p>修改后，使用 <code>useradd</code> 命令无需 <code>-s /bin/zsh</code>，用户默认使用 zsh，当然也可以不修改此项，<code>useradd</code> 命令继续追加 <code>-s /bin/zsh</code> 参数。</p>
<p>新用户登录后，将自动复制 .zshrc 和上述 cache 目录到用户主目录下，并自动加载 zsh 配置。</p>
<p>针对现有用户</p>
<p>直接复制 <code>/etc/skel/.zshrc</code> 到 <code>~/</code></p>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp /etc/skel/.zshrc ~/.zshrc
</span></span><span class="line"><span class="cl"><span class="nb">source</span> ~/.zshrc</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="git">Git</h3>
<h4 id="解决中文乱码">解决中文乱码</h4>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git config --global core.quotepath false</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="docker">Docker</h3>
<p>以下操作需要在 root 用户下完成，请使用 <code>sudo -i</code> 或 <code>su root</code> 切换到 root 用户进行操作。</p>
<p>首先，安装一些必要的软件包：</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update
</span></span><span class="line"><span class="cl">apt upgrade -y
</span></span><span class="line"><span class="cl">apt install curl vim wget gnupg apt-transport-https lsb-release ca-certificate</span></span></code></pre></td></tr></table>
</div>
</div><p>然后加入 Docker 的 GPG 公钥和 apt 源：</p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O /usr/share/keyrings/docker.asc https://download.docker.com/linux/debian/gpg
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [signed-by=/usr/share/keyrings/docker.asc] https://download.docker.com/linux/debian </span><span class="k">$(</span>lsb_release -sc<span class="k">)</span><span class="s2"> stable&#34;</span> &gt; /etc/apt/sources.list.d/docker.list</span></span></code></pre></td></tr></table>
</div>
</div><p>国内机器可以用清华 TUNA的国内源：</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O /usr/share/keyrings/docker.asc https://download.docker.com/linux/debian/gpg
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;deb [signed-by=/usr/share/keyrings/docker.asc] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian </span><span class="k">$(</span>lsb_release -sc<span class="k">)</span><span class="s2"> stable&#34;</span> &gt; /etc/apt/sources.list.d/docker.list</span></span></code></pre></td></tr></table>
</div>
</div><p>然后更新系统后即可安装 Docker CE：</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update
</span></span><span class="line"><span class="cl">apt-get install docker-ce docker-ce-cli containerd.io</span></span></code></pre></td></tr></table>
</div>
</div><p>此时可以使用 <code>docker version</code> 命令检查是否安装成功：</p>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@debian:~## docker version
</span></span><span class="line"><span class="cl">Client: Docker Engine - Community
</span></span><span class="line"><span class="cl"> Version:           23.0.1
</span></span><span class="line"><span class="cl"> API version:       1.42
</span></span><span class="line"><span class="cl"> Go version:        go1.19.5
</span></span><span class="line"><span class="cl"> Git commit:        a5ee5b1
</span></span><span class="line"><span class="cl"> Built:             Thu Feb  <span class="m">9</span> 19:46:54 <span class="m">2023</span>
</span></span><span class="line"><span class="cl"> OS/Arch:           linux/amd64
</span></span><span class="line"><span class="cl"> Context:           default
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Server: Docker Engine - Community
</span></span><span class="line"><span class="cl"> Engine:
</span></span><span class="line"><span class="cl">  Version:          23.0.1
</span></span><span class="line"><span class="cl">  API version:      1.42 <span class="o">(</span>minimum version 1.12<span class="o">)</span>
</span></span><span class="line"><span class="cl">  Go version:       go1.19.5
</span></span><span class="line"><span class="cl">  Git commit:       bc3805a
</span></span><span class="line"><span class="cl">  Built:            Thu Feb  <span class="m">9</span> 19:46:54 <span class="m">2023</span>
</span></span><span class="line"><span class="cl">  OS/Arch:          linux/amd64
</span></span><span class="line"><span class="cl">  Experimental:     <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> containerd:
</span></span><span class="line"><span class="cl">  Version:          1.6.18
</span></span><span class="line"><span class="cl">  GitCommit:        2456e983eb9e37e47538f59ea18f2043c9a73640
</span></span><span class="line"><span class="cl"> runc:
</span></span><span class="line"><span class="cl">  Version:          1.1.4
</span></span><span class="line"><span class="cl">  GitCommit:        v1.1.4-0-g5fd4c4d
</span></span><span class="line"><span class="cl"> docker-init:
</span></span><span class="line"><span class="cl">  Version:          0.19.0
</span></span><span class="line"><span class="cl">  GitCommit:        de40ad0</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="常用命令">常用命令</h4>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 跟踪日志</span>
</span></span><span class="line"><span class="cl">docker logs -f --tail<span class="o">=</span><span class="m">200</span> xxx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除未使用的镜像</span>
</span></span><span class="line"><span class="cl">docker image prune</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="docker-compose">Docker Compose</h4>
<p>我们可以使用 Docker 官方发布的 Github 直接安装最新版本：</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-Linux-x86_64 &gt; /usr/local/bin/docker-compose
</span></span><span class="line"><span class="cl">chmod +x /usr/local/bin/docker-compose</span></span></code></pre></td></tr></table>
</div>
</div><p>此时可以使用 <code>docker-compose version</code> 命令检查是否安装成功：</p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@debian ~ <span class="c1"># docker-compose version</span>
</span></span><span class="line"><span class="cl">Docker Compose version v2.16.0</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="修改-docker-配置">修改 Docker 配置</h4>
<p>以下配置会增加一段自定义内网 IPv6 地址，开启容器的 IPv6 功能，以及限制日志文件大小，防止 Docker 日志塞满硬盘（泪的教训）：</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; /etc/docker/daemon.json
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;log-driver&#34;</span>: <span class="s2">&#34;json-file&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;log-opts&#34;</span>: <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;max-size&#34;</span>: <span class="s2">&#34;20m&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;max-file&#34;</span>: <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ipv6&#34;</span>: true,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;fixed-cidr-v6&#34;</span>: <span class="s2">&#34;fd00:dead:beef:c0::/80&#34;</span>,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;experimental&#34;</span>:true,
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ip6tables&#34;</span>:true
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后重启 Docker 服务：</p>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl restart docker</span></span></code></pre></td></tr></table>
</div>
</div><p>好了，我们已经安装好了 Docker 和 Docker Compose，然后就可以开始愉快的安装各种软件。</p>
<h3 id="scp-上传下载文件">scp 上传下载文件</h3>
<p><strong>1、上传本地文件到服务器</strong></p>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp /path/filename username@servername:/path/</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>2、从服务器上下载文件</strong></p>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp username@servername:/path/filename /var/www/local<span class="se">\_</span>dir<span class="o">(</span>本地目录<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>3、从服务器下载整个目录</strong></p>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp -r username@servername:/var/www/remote<span class="se">\_</span>dir/<span class="o">(</span>远程目录<span class="o">)</span> /var/www/local<span class="se">\_</span>dir<span class="o">(</span>本地目录<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>4、上传目录到服务器</strong></p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp -r local<span class="se">\_</span>dir username@servername:remote<span class="se">\_</span>dir</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="挂载">挂载</h2>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 只可以查看已经挂载的分区和文件系统类型。</span>
</span></span><span class="line"><span class="cl">df -T
</span></span><span class="line"><span class="cl"><span class="c1"># 可以显示出所有挂载和未挂载的分区，但不显示文件系统类型。</span>
</span></span><span class="line"><span class="cl">fdisk -l
</span></span><span class="line"><span class="cl"><span class="c1"># 也可以查看未挂载的文件系统类型。</span>
</span></span><span class="line"><span class="cl">lsblk -f
</span></span><span class="line"><span class="cl"><span class="c1"># 可以查看未挂载的文件系统类型，以及哪些分区尚未格式化。</span>
</span></span><span class="line"><span class="cl">parted -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 开机自动挂载</span>
</span></span><span class="line"><span class="cl">vi /etc/fstab</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="硬盘">硬盘</h3>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 在 fstab 文件末位增加一行，用于设置开机自动挂载 硬盘</span>
</span></span><span class="line"><span class="cl"><span class="nv">UUID</span><span class="o">=</span>25b53c64-94ec-4bd6-a322-a1b776ad86c1 /mnt/hdd1 ext4 <span class="nv">errors</span><span class="o">=</span>remount-ro <span class="m">0</span> <span class="m">2</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cifs">cifs</h3>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 单次挂载</span>
</span></span><span class="line"><span class="cl">mount -t cifs //192.168.9.23/Disk_sataa5 /mnt/zidoo -o <span class="nv">username</span><span class="o">=</span>xxx,password<span class="o">=</span>xxx
</span></span><span class="line"><span class="cl">mount -t cifs //192.168.9.23/Disk_sataa5 /mnt/zidoo -o <span class="nv">username</span><span class="o">=</span>guest,password<span class="o">=</span>guest
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 在 fstab 文件末位增加一行，用于设置开机自动挂载 smb</span>
</span></span><span class="line"><span class="cl">//192.168.9.23/Disk_sataa5 /mnt/zidoo cifs <span class="nv">uid</span><span class="o">=</span>0,gid<span class="o">=</span>0,username<span class="o">=</span>xxx,password<span class="o">=</span>xxx,sec<span class="o">=</span>ntlm <span class="m">0</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">//192.168.9.23/Disk_sataa5 /mnt/zidoo cifs defaults <span class="m">0</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 若报错可尝试先安装cifs工具包</span>
</span></span><span class="line"><span class="cl">apt install cifs-utils</span></span></code></pre></td></tr></table>
</div>
</div><p>参考</p>
<ol>
<li><a href="https://zhuanlan.zhihu.com/p/402960046?utm_id=0"target="_blank" rel="external nofollow noopener noreferrer">Debian 11 “bullseye” 安装笔记</a></li>
<li><a href="https://sysin.org/blog/linux-zsh-all/"target="_blank" rel="external nofollow noopener noreferrer">Linux 全局安装配置 zsh + oh-my-zsh</a></li>
<li><a href="https://www.mumupc.com/archives/20226.html"target="_blank" rel="external nofollow noopener noreferrer">非桌面版Debian 11自动配置获取ipv6地址教程</a></li>
<li><a href="https://blog.csdn.net/tyro_java/article/details/53439537"target="_blank" rel="external nofollow noopener noreferrer">在git中出现中文乱码的解决方案</a></li>
</ol>]]></description></item><item><title>VPS到手基本流程</title><link>https://blog.iqzhi.com/posts/vps-basic/</link><pubDate>Sat, 18 Feb 2023 12:20:05 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/vps-basic/</guid><description><![CDATA[<p>记录玩VPS的点滴。</p>
<h2 id="一-简介">一 简介</h2>
<p>记录玩VPS的点滴。</p>
<h2 id="二-关键记录">二 关键记录</h2>
<h3 id="1-debian">1 Debian</h3>
<blockquote>
<p>适用版本：11（Bullseye）、12</p>
</blockquote>
<h4 id="11-查看内核版本">1.1 查看内核版本</h4>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">uname -r</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="12-开启ssh登录">1.2 开启SSH登录</h4>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/#PermitRootLogin prohibit-password/PermitRootLogin yes/g&#39;</span> /etc/ssh/sshd_config
</span></span><span class="line"><span class="cl">systemctl restart ssh</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="13-更新系统包">1.3 更新系统包</h4>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update -y <span class="o">&amp;&amp;</span> apt upgrade -y</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i><code>apt-get update失败 Err:1 http://archive.ubuntu.com/ubuntu xenial InRelease</code><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>出现此问题，一般是因为DNS设置的问题，将DNS设置为 <em>8.8.8.8</em></p>
<p>通过下面命令查看DNS</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /etc/resolv.conf</span></span></code></pre></td></tr></table>
</div>
</div><p>通过下面命令修改DNS</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;nameserver 8.8.8.8&#34;</span> <span class="p">|</span> tee /etc/resolv.conf &gt; /dev/null</span></span></code></pre></td></tr></table>
</div>
</div><p>修改后再次查看</p>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /etc/resolv.conf
</span></span><span class="line"><span class="cl">nameserver 8.8.8.8</span></span></code></pre></td></tr></table>
</div>
</div><p>说明设置成功。</p>
</div>
    </div>
  </div>
<h4 id="14-安装常用软件">1.4 安装常用软件</h4>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install -y sudo
</span></span><span class="line"><span class="cl">apt install -y curl
</span></span><span class="line"><span class="cl">apt install -y socat</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-系统通用">4 系统通用</h3>
<h3 id="41-ip">4.1 IP</h3>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -4 ip.sb
</span></span><span class="line"><span class="cl">curl -6 ip.sb</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="42-网络互联">4.2 网络互联</h3>
<p><a href="https://www.itdog.cn/"target="_blank" rel="external nofollow noopener noreferrer">ITDOG</a></p>
<p><a href="http://ip.ping0.cc/"target="_blank" rel="external nofollow noopener noreferrer">PING0</a></p>
<p><a href="https://ping.pe/"target="_blank" rel="external nofollow noopener noreferrer">ping.pe</a></p>
<h3 id="43-融合怪脚本">4.3 融合怪脚本</h3>
<p>这个脚本非常不错，虽然是个融合脚本但是有很多别的脚本测不了的东西，有网络信息，IP信息，解锁信息，常用端口开放信息，硬件信息等。关于IP质量问题除了这个以外，IP信息还可以去这里查询，结果非常详细：https://ipinfo.io/</p>
<p>github项目地址：https://github.com/spiritLHLS/ecs</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>wget -qO- --no-check-certificate https://github.com/spiritLHLS/ecs/raw/main/ecs.sh<span class="o">)</span>
</span></span><span class="line"><span class="cl">bash &lt;<span class="o">(</span>wget -qO- --no-check-certificate https://gitlab.com/spiritysdx/za/-/raw/main/ecs.sh<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="44-添加-swap">4.4 添加 SWAP</h3>
<p>swap 是 Linux 中的虚拟内存，用于扩充物理内存不足而用来存储临时数据存在的。它类似于 Windows 中的虚拟内存。在 Windows 中，只可以使用文件来当作虚拟内存。而 linux 可以文件或者分区来当作虚拟内存。</p>
<p>这个虚拟内存对于内存小的 VPS 非常有必要，可以提高我们的运行效率。<code>建议设置为实际ram的 2 倍。</code></p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -O box.sh https://raw.githubusercontent.com/BlueSkyXN/SKY-BOX/main/box.sh <span class="o">&amp;&amp;</span> chmod +x box.sh <span class="o">&amp;&amp;</span> clear <span class="o">&amp;&amp;</span> ./box.sh</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="45-哪吒监控">4.5 哪吒监控</h3>
<p>从自建部署的监控管理后台直接拿命令。</p>
<h3 id="46-docker">4.6 Docker</h3>
<p>官方一键安装脚本</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -qO- get.docker.com <span class="p">|</span> bash
</span></span><span class="line"><span class="cl"><span class="c1">#查看docker版本</span>
</span></span><span class="line"><span class="cl">docker -v</span></span></code></pre></td></tr></table>
</div>
</div><p>Docker-compose 安装</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-Linux-x86_64 &gt; /usr/local/bin/docker-compose
</span></span><span class="line"><span class="cl">sudo chmod +x /usr/local/bin/docker-compose
</span></span><span class="line"><span class="cl">docker-compose --version</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="461-修改-docker-配置">4.6.1 修改 Docker 配置</h4>
<p>以下配置会增加一段自定义内网 IPv6 地址，开启容器的 IPv6 功能，以及限制日志文件大小，防止 Docker 日志塞满硬盘（泪的教训）：</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; /etc/docker/daemon.json <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">{
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;log-driver&#34;: &#34;json-file&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;log-opts&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s">        &#34;max-size&#34;: &#34;20m&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s">        &#34;max-file&#34;: &#34;3&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    },
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;ipv6&#34;: true,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;fixed-cidr-v6&#34;: &#34;fd00:dead:beef:c0::/80&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;experimental&#34;:true,
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;ip6tables&#34;:true
</span></span></span><span class="line"><span class="cl"><span class="s">}
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后重启 Docker 服务：</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl restart docker</span></span></code></pre></td></tr></table>
</div>
</div><p>好了，我们已经安装好了 Docker 和 Docker Compose，然后就可以开始愉快的安装各种软件。</p>
<h3 id="47-zerotier">4.7 ZeroTier</h3>
<p>安装</p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -s https://install.zerotier.com/ <span class="p">|</span> bash</span></span></code></pre></td></tr></table>
</div>
</div><p>填写网络ID，加入异地虚拟网络</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zerotier-cli join <span class="o">(</span>网络ID<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>如果看见<code>200 join OK</code>字样就说明成功加入异地虚拟局域网了。</p>
<h3 id="48-warp">4.8 Warp</h3>
<p>各大一键脚本，三选一即可。</p>
<p><a href="https://github.com/fscarmen/warp"target="_blank" rel="external nofollow noopener noreferrer">FSCARMEN</a> :</p>
<ul>
<li>首次运行
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -N https://raw.githubusercontent.com/fscarmen/warp/main/menu.sh <span class="o">&amp;&amp;</span> bash menu.sh</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>日常维护 <code>warp</code></li>
</ul>
<p><a href="https://github.com/P3TERX/warp.sh"target="_blank" rel="external nofollow noopener noreferrer">P3TERX</a> :</p>
<ul>
<li>首次运行
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash &lt;<span class="o">(</span>curl -fsSL git.io/warp.sh<span class="o">)</span> menu</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>日常维护 <code>bash warp.sh</code></li>
</ul>
<p><a href="https://gitlab.com/ProjectWARP/warp-go/-/tree/master/"target="_blank" rel="external nofollow noopener noreferrer">WARP-GO</a> :</p>
<ul>
<li>首次运行
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -N https://raw.githubusercontent.com/fscarmen/warp/main/warp-go.sh <span class="o">&amp;&amp;</span> bash warp-go.sh</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>日常维护 <code>warp-go</code></li>
</ul>]]></description></item><item><title>哪吒监控 - 轻量服务器运维监控工具</title><link>https://blog.iqzhi.com/posts/nezha/</link><pubDate>Mon, 13 Feb 2023 21:25:54 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/nezha/</guid><description><![CDATA[<p><a href="https://nezha.wiki"target="_blank" rel="external nofollow noopener noreferrer">哪吒监控</a>，可以说是拿到VPS，更新完系统后，几乎第一个就要装的监控程序。</p>
<p>几乎支持各种系统部署。</p>
<h2 id="透明主题">透明主题</h2>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">style</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* 屏幕适配 */</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="nx">media</span> <span class="nx">only</span> <span class="nx">screen</span> <span class="nx">and</span> <span class="p">(</span><span class="nx">min</span><span class="o">-</span><span class="nx">width</span><span class="o">:</span> <span class="mi">1200</span><span class="nx">px</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">container</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span><span class="o">:</span> <span class="mi">80</span><span class="o">%</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="nx">media</span> <span class="nx">only</span> <span class="nx">screen</span> <span class="nx">and</span> <span class="p">(</span><span class="nx">max</span><span class="o">-</span><span class="nx">width</span><span class="o">:</span> <span class="mi">767</span><span class="nx">px</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">card</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">content</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">header</span><span class="o">:</span><span class="nx">not</span><span class="p">(.</span><span class="nx">ui</span><span class="p">),</span> <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">cards</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">card</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">content</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">header</span><span class="o">:</span><span class="nx">not</span><span class="p">(.</span><span class="nx">ui</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">margin</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mf">0.4</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 整体图标 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">i</span><span class="p">.</span><span class="nx">icon</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">width</span><span class="o">:</span> <span class="mf">1.2</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 背景图片 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34; &#34;</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="nx">fixed</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">z</span><span class="o">-</span><span class="nx">index</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">top</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">right</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">left</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">position</span><span class="o">:</span> <span class="nx">top</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">repeat</span><span class="o">:</span> <span class="nx">no</span><span class="o">-</span><span class="nx">repeat</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">size</span><span class="o">:</span> <span class="nx">cover</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">image</span><span class="o">:</span> <span class="nx">url</span><span class="p">(</span><span class="nx">https</span><span class="o">:</span><span class="c1">//gitee.com/darki/img/raw/master/1631081013043.webp) !important;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Arial</span><span class="p">,</span><span class="nx">Helvetica</span><span class="p">,</span><span class="nx">sans</span><span class="o">-</span><span class="nx">serif</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 导航栏 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">large</span><span class="p">.</span><span class="nx">menu</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">55</span><span class="o">%</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 首页按钮 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">menu</span> <span class="p">.</span><span class="nx">active</span><span class="p">.</span><span class="nx">item</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 导航栏下拉框 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">dropdown</span> <span class="p">.</span><span class="nx">menu</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">80</span><span class="o">%</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 登陆按钮 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">nezha</span><span class="o">-</span><span class="nx">primary</span><span class="o">-</span><span class="nx">btn</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 大卡片 */</span>
</span></span><span class="line"><span class="cl"><span class="err">#</span><span class="nx">app</span> <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">fluid</span><span class="p">.</span><span class="nx">accordion</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fbfbfb26</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mf">0.4</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 小卡片 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">four</span><span class="p">.</span><span class="nx">cards</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">card</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mf">0.6</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaa3</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">wide</span><span class="p">.</span><span class="nx">column</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">padding</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">padding</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">height</span><span class="o">:</span> <span class="mf">3.3</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">three</span><span class="p">.</span><span class="nx">wide</span><span class="p">.</span><span class="nx">column</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">padding</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="mi">0</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">wide</span><span class="p">.</span><span class="nx">column</span><span class="o">:</span><span class="nx">nth</span><span class="o">-</span><span class="nx">child</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mi">2</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">wide</span><span class="p">.</span><span class="nx">column</span><span class="o">:</span><span class="nx">nth</span><span class="o">-</span><span class="nx">child</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mi">2</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">description</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">padding</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 小鸡名 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">flag</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="mf">0.5</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 弹出卡片图标 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">header</span> <span class="o">&gt;</span> <span class="p">.</span><span class="nx">info</span><span class="p">.</span><span class="nx">icon</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">nezha</span><span class="o">-</span><span class="nx">secondary</span><span class="o">-</span><span class="nx">font</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">21</span><span class="nx">ba45</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 进度条 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">50</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">min</span><span class="o">-</span><span class="nx">width</span><span class="o">:</span> <span class="mf">1.8</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">15</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">line</span><span class="o">-</span><span class="nx">height</span><span class="o">:</span> <span class="mf">1.65</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">fine</span><span class="p">.</span><span class="nx">progress</span><span class="o">&gt;</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">21</span><span class="nx">ba45</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span><span class="o">&gt;</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span><span class="p">.</span><span class="nx">fine</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">21</span><span class="nx">ba45</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span><span class="p">.</span><span class="nx">warning</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">ff9800</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span><span class="p">.</span><span class="nx">error</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">e41e10</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">progress</span><span class="p">.</span><span class="nx">offline</span> <span class="p">.</span><span class="nx">bar</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 上传下载 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">outline</span><span class="p">.</span><span class="nx">icon</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">i</span><span class="p">.</span><span class="nx">arrow</span><span class="p">.</span><span class="nx">alternate</span><span class="p">.</span><span class="nx">circle</span><span class="p">.</span><span class="nx">down</span><span class="p">.</span><span class="nx">outline</span><span class="p">.</span><span class="nx">icon</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">21</span><span class="nx">ba45</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">i</span><span class="p">.</span><span class="nx">arrow</span><span class="p">.</span><span class="nx">alternate</span><span class="p">.</span><span class="nx">circle</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">outline</span><span class="p">.</span><span class="nx">icon</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="nx">red</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 弹出卡片小箭头 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">:</span> <span class="o">-</span><span class="mi">3</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mf">0.914286</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">transform</span><span class="o">-</span><span class="nx">origin</span><span class="o">:</span> <span class="nx">left</span> <span class="mi">50</span><span class="o">%</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">transform</span><span class="o">-</span><span class="nx">origin</span><span class="o">:</span> <span class="nx">left</span> <span class="mi">50</span><span class="o">%</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">bottom</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">left</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mi">3</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">left</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">right</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">8</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">:</span> <span class="o">-</span><span class="mi">3</span><span class="nx">px</span> <span class="p">.</span><span class="mi">91428571</span><span class="nx">em</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">transform</span><span class="o">-</span><span class="nx">origin</span><span class="o">:</span> <span class="nx">right</span> <span class="mi">50</span><span class="o">%</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">transform</span><span class="o">-</span><span class="nx">origin</span><span class="o">:</span> <span class="nx">right</span> <span class="mi">50</span><span class="o">%</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="nx">solid</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">bottom</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">tap</span><span class="o">-</span><span class="nx">highlight</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">bottom</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">tap</span><span class="o">-</span><span class="nx">highlight</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">tap</span><span class="o">-</span><span class="nx">highlight</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">top</span><span class="p">.</span><span class="nx">right</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">tap</span><span class="o">-</span><span class="nx">highlight</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">left</span><span class="p">.</span><span class="nx">center</span><span class="p">.</span><span class="nx">popup</span><span class="o">:</span><span class="nx">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="nx">transparent</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">box</span><span class="o">-</span><span class="nx">shadow</span><span class="o">:</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span><span class="nx">px</span> <span class="mi">0</span> <span class="mi">0</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">-</span><span class="nx">webkit</span><span class="o">-</span><span class="nx">tap</span><span class="o">-</span><span class="nx">highlight</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 弹出卡片 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">cards</span> <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">popup</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">min</span><span class="o">-</span><span class="nx">width</span><span class="o">:</span> <span class="mi">20</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">line</span><span class="o">-</span><span class="nx">height</span><span class="o">:</span> <span class="mi">2</span><span class="nx">rem</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">-</span><span class="nx">radius</span><span class="o">:</span> <span class="mi">5</span><span class="nx">px</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">border</span><span class="o">:</span> <span class="mi">1</span><span class="nx">px</span> <span class="nx">solid</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaeb</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">font</span><span class="o">-</span><span class="nx">family</span><span class="o">:</span> <span class="nx">Arial</span><span class="p">,</span><span class="nx">Helvetica</span><span class="p">,</span><span class="nx">sans</span><span class="o">-</span><span class="nx">serif</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">content</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">margin</span><span class="o">:</span> <span class="mi">0</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">padding</span><span class="o">:</span> <span class="mi">1</span><span class="nx">em</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 服务页 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">table</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="nx">RGB</span><span class="p">(</span><span class="mi">225</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">table</span> <span class="nx">thead</span> <span class="nx">th</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">:</span> <span class="nx">transparent</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 服务页进度条 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">service</span><span class="o">-</span><span class="nx">status</span> <span class="p">.</span><span class="nx">good</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">21</span><span class="nx">ba45</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">service</span><span class="o">-</span><span class="nx">status</span> <span class="p">.</span><span class="nx">danger</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">red</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">service</span><span class="o">-</span><span class="nx">status</span> <span class="p">.</span><span class="nx">warning</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="nx">orange</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* 版权 */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">inverted</span><span class="p">.</span><span class="nx">segment</span><span class="p">,</span> <span class="p">.</span><span class="nx">ui</span><span class="p">.</span><span class="nx">primary</span><span class="p">.</span><span class="nx">inverted</span><span class="p">.</span><span class="nx">segment</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">font</span><span class="o">-</span><span class="nx">weight</span><span class="o">:</span> <span class="nx">bold</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">background</span><span class="o">-</span><span class="nx">color</span><span class="o">:</span> <span class="err">#</span><span class="nx">fafafaa3</span> <span class="o">!</span><span class="nx">important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/style&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--</span><span class="nx">Logo和版权</span><span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">avatar</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&#34;.item img&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">footer</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&#34;div.is-size-7&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">footer</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&#34;SimplyMiss の 天眼&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">footer</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&#34;visible&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">avatar</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">&#34;https://blog.870211.xyz/images/maple-transparent.png&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">avatar</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span><span class="o">=</span><span class="s2">&#34;visible&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">faviconurl</span><span class="o">=</span><span class="s2">&#34;https://b.izhi.ml/images/maple-transparent.png&#34;</span> <span class="p">;</span>            
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&#34;link[rel*=&#39;icon&#39;]&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">link</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;image/x-icon&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">link</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">&#39;shortcut icon&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">faviconurl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">link</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/script&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="custom主题-转载httpsblogamzayocomindexphparchives28">Custom主题 <a href="https://blog.amzayo.com/index.php/archives/28/"target="_blank" rel="external nofollow noopener noreferrer">转载</a></h2>
<p><img loading="lazy" src="https://cdn.amzayo.top/static/imgs/21.png" srcset="https://cdn.amzayo.top/static/imgs/21.png?size=small, https://cdn.amzayo.top/static/imgs/21.png?size=medium 1.5x, https://cdn.amzayo.top/static/imgs/21.png?size=large 2x" sizes="auto" data-title="show" data-alt="show" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><a href="https://cdn.amzayo.top/static/public/amzayo_template_fin_2.91.zip"target="_blank" rel="external nofollow noopener noreferrer">下载地址</a></p>
<p>使用方法
1.template里面的文件解压出来放到服务端/opt/nezha/dashboard/theme-custom/template目录里面</p>
<p>2.重启哪吒面板服务</p>
<p>3.在哪吒面板后台主题选择Custom(local)</p>
<p>4.将css.txt里面的CSS样式代码复制到哪吒面板后台的“自定义代码”文本框里</p>
<h2 id="注意事项">注意事项</h2>
<ul>
<li>将面板和数据域名换成https的过程中，如果套在CloudFlare上，建议使用<code>完全</code>或<code>完全（严格）</code>的方式，因为如果使用的是<code>灵活</code>，CloudFlare有可能回落使用80端口与服务器间的访问，导致连通性各种问题，时通时不通。</li>
</ul>]]></description></item><item><title>Hexo版本更新</title><link>https://blog.iqzhi.com/posts/hexo-upgrade/</link><pubDate>Wed, 08 Feb 2023 10:36:06 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/hexo-upgrade/</guid><description><![CDATA[<p>记录升级Hexo的注意事项。</p>
<h2 id="升级hexo">升级Hexo</h2>
<h3 id="npm的全局软件更新">npm的全局软件更新</h3>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 清理NPM缓存</span>
</span></span><span class="line"><span class="cl">$ npm cache clean -f
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 全局安装版本检测、版本升级工具</span>
</span></span><span class="line"><span class="cl">$ npm install -g npm-check
</span></span><span class="line"><span class="cl">$ npm install -g npm-upgrade
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 全局检测哪些模块可以升级，这里可以根据打印的提示信息，手动安装最新版本的模块</span>
</span></span><span class="line"><span class="cl">$ npm-check -g
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 全局更新模块</span>
</span></span><span class="line"><span class="cl">$ npm update -g
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 全局安装或更新Hexo的最新版本</span>
</span></span><span class="line"><span class="cl">$ npm install --global hexo</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="hexo当前目录的软件更新">hexo当前目录的软件更新</h3>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># 进入博客的根目录</span>
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> /blog-root
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 检测Hexo哪些模块可以升级</span>
</span></span><span class="line"><span class="cl">$ npm-check
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除package-lock.json</span>
</span></span><span class="line"><span class="cl"><span class="c1"># rm -rf package-lock.json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 更新package.json，一直回车即可</span>
</span></span><span class="line"><span class="cl">$ npm-upgrade
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除整个模块目录，这样可以避免很多坑</span>
</span></span><span class="line"><span class="cl">$ rm -rf node_modules
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 更新Hexo的模块</span>
</span></span><span class="line"><span class="cl">$ npm update --save
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 若出现依赖的问题，用以下命令检查一下，然后把报错的统一修复一下即可</span>
</span></span><span class="line"><span class="cl">$ npm audix
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或者强制更新</span>
</span></span><span class="line"><span class="cl">$ npm update --save --force</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="检查">检查</h3>
<p>做完上述步骤完成后，可<code>package.json</code>检查文件中版本信息。</p>
<h3 id="完成">完成</h3>
<p>至此Hexo的升级就结束了，但是不要着急将源文件上传到仓库，先在本地三连一下<code>hexo clean &amp;&amp; hexo g -d</code>，如果在执行<code>Hexo d</code>的时候报错了，可以尝试删除<code>.deploy_git</code>文件夹里面的内容，这个是前面生成的网站项目内容，与当前的不兼容。</p>
<h3 id="参考链接">参考链接</h3>
<ul>
<li><a href="https://blog.sianx.com/posts/f16f368c/"target="_blank" rel="external nofollow noopener noreferrer">Hexo版本更新</a></li>
</ul>]]></description></item><item><title>Zsh - Shell中极品</title><link>https://blog.iqzhi.com/posts/zsh-the-best-in-shell/</link><pubDate>Tue, 14 Jun 2022 16:14:41 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/zsh-the-best-in-shell/</guid><description><![CDATA[<p>zsh固然是好工具，但配置使用也同样重要，一定要“就手”。</p>
<h2 id="前言">前言</h2>
<p><a href="https://en.wikipedia.org/wiki/Z_shell"target="_blank" rel="external nofollow noopener noreferrer">zsh</a>是来自普林斯顿大学的学生Paul Falstad于1990年发布的，这名字来自于当时也是普林斯顿大学的一名助教Zhong Shao（后来成为耶鲁大学教授）的login-id。zsh一开始的设计初衷是为Commodore公司于1985年出的个人电脑Amiga设计一个开源的csh的子集，结果一不小心就暴走了；它在发布的时候，已经成为了ksh和tcsh的交集——既吸收了ksh在命令式可编程脚本语言上的良好逻辑设计，又吸收了tcsh丝滑般的交互体验，集众家之长，自然牛逼了。</p>
<p>2019年，Apple的macOS Catalina将zsh作为默认shell，取代了bash；2020年，Kali Linux（一个著名的安全领域的Linux操作系统）从2020.4版本后，也将zsh作为默认shell。</p>
<h3 id="简介">简介</h3>
<p>zsh 是一个 Linux 下强大的 shell, 由于大多数 Linux 产品安装，以及默认使用bash shell, 但是丝毫不影响极客们对 zsh 的热衷, 几乎每一款 Linux 产品都包含有 zsh，通常可以用 apt-get、urpmi 或 yum 等包管理器进行安装。</p>
<p>zsh 具有以下主要功能：</p>
<ul>
<li>开箱即用、可编程的命令行补全功能可以帮助用户输入各种参数以及选项；</li>
<li>在用户启动的所有 shell 中共享命令历史；</li>
<li>通过扩展的文件通配符，可以不利用外部命令达到 find 命令一般展开文件名；</li>
<li>改进的变量与数组处理；</li>
<li>在缓冲区中编辑多行命令；</li>
<li>多种兼容模式，例如使用 / bin/sh 运行时可以伪装成 Bourne shell；</li>
<li>可以定制呈现形式的提示符；包括在屏幕右端显示信息，并在键入长命令时自动隐藏；</li>
<li>可加载的模块，提供其他各种支持：完整的 TCP 与 Unix 域套接字控制，FTP 客户端与扩充过的数学函数；</li>
<li>完全可定制化。</li>
</ul>
<p>可见，zsh缺点就是配置太麻烦，好在有一个叫做oh-my-zsh的开源项目，很好的弥补了这一缺陷，只需要修修改改配置文件，就能很顺手。</p>
<h2 id="安装配置">安装配置</h2>
<h3 id="zsh">zsh</h3>
<p>在 CentOS7 下，执行<code>yum</code>命令来安装需要的<code>zsh</code>原始程序与<code>git</code>程序来<code>pull</code>代码。</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">yum install -y zsh git
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 查看系统shell</span>
</span></span><span class="line"><span class="cl">cat /etc/shells
</span></span><span class="line"><span class="cl"><span class="c1"># 或</span>
</span></span><span class="line"><span class="cl">chsh -l
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 更换</span>
</span></span><span class="line"><span class="cl">chsh -s /bin/zsh
</span></span><span class="line"><span class="cl"><span class="c1"># 或</span>
</span></span><span class="line"><span class="cl">chsh -s <span class="k">$(</span>which zsh<span class="k">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="oh-my-zsh">oh-my-zsh</h3>
<p>安装<a href="https://github.com/ohmyzsh/ohmyzsh"target="_blank" rel="external nofollow noopener noreferrer">oh-my-zsh</a>脚本 (这一步需要先安装 git)。</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sh -c <span class="s2">&#34;</span><span class="k">$(</span>wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class="k">)</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="powerline字体">Powerline字体</h3>
<p>oh-my-zsh配置中采用的是Powerline字体，本地环境中若不包含该系列字体，则会出现乱码的问题。</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># clone</span>
</span></span><span class="line"><span class="cl">git clone https://github.com/powerline/fonts.git --depth<span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># install</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> fonts
</span></span><span class="line"><span class="cl">./install.sh
</span></span><span class="line"><span class="cl"><span class="c1"># clean-up a bit</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ..
</span></span><span class="line"><span class="cl">rm -rf fonts
</span></span><span class="line"><span class="cl"><span class="c1"># uninstall</span>
</span></span><span class="line"><span class="cl">./uninstall.sh</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="配置-zshrc">配置 ~/.zshrc</h3>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># 配置主题
</span></span><span class="line"><span class="cl">ZSH_THEME=&#34;agnoster&#34;</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="插件">插件</h2>
<p>使用 ZSH 替换原有的 SHELL 最主要的原因就是要使用其功能强大的插件，这里只推荐安装三个插件，它们分别是 wd、zsh-syntax-highlighting、zsh-autosuggestions 。</p>
<p>获取安装：</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.oh-my-zsh/custom/plugins
</span></span><span class="line"><span class="cl">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git
</span></span><span class="line"><span class="cl">git clone https://github.com/zsh-users/zsh-autosuggestions.git</span></span></code></pre></td></tr></table>
</div>
</div><p>编辑 ~/.zshrc 增加配置：</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">plugins=(git wd zsh-syntax-highlighting zsh-autosuggestions)
</span></span><span class="line"><span class="cl">source ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
</span></span><span class="line"><span class="cl">source ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="更多">更多</h2>
<h3 id="vscode中设置终端">vscode中设置终端</h3>
<p>在<code>setting</code>中搜索<code>terminal</code>选项，然后修改<code>Integrated: Font Family</code>的值为powerline字体即可。例如本人采用的是 Source Code Pro for Powerline 。</p>]]></description></item><item><title>Cmder - 替代Cmd，打造Windows命令行军刀</title><link>https://blog.iqzhi.com/posts/cmder/</link><pubDate>Wed, 04 Oct 2017 11:11:42 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/cmder/</guid><description><![CDATA[<p>Windows下终端工具。</p>
<h2 id="简介">简介</h2>
<p><a href="http://cmder.net/"target="_blank" rel="external nofollow noopener noreferrer">Cmder</a>是一款Windows下终端工具，增强命令行的存在，把conemu，msysgit和clink打包在一起，让你无需配置就能使用一个真正干净的Linux终端！她甚至还附带了漂亮的monokai配色主题。官网下载的安装包其实是压缩档, 可即压即用。你甚至可以放到USB就可以虽时带着走，连调整过的设定都会放在这个目录下，不会用到系统机码(Registry)，所以也很适合放在Dropbox/Google Drive/OneDrive共享于多台电脑。</p>
<p>下载的时候，有两个版本，分别是mini与full版；唯一的差别在于有没有内建msysgit工具，这是Git for Windows的标准配备；全安装版cmder自带了msysgit, 压缩包23M, 除了git本身这个命令之外, 里面可以使用大量的linux命令；比如grep，curl(没有wget)；像vim，grep，tar，unzip，ssh，ls，bash，perl对于爱折腾的Coder更是痛点需求。</p>
<h2 id="定制配置">定制配置</h2>
<p>为了军刀更锋利，更好用，少不了折腾一下配置，让它更适合个人的使用习惯。</p>
<ul>
<li>
<p>打开管理员权限终端
输入<code>Ctrl + t</code>，或者点击下面控制条的绿色加号，勾选&quot;Run as administrator&quot;</p>
</li>
<li>
<p>添加 cmder 到右键菜单
打开管理员权限的终端，去到Cmder根目录，输入以下语句即可：</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Cmder.exe /REGISTER ALL</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>解决文字重叠问题
<code>Win + ALT + P</code> 唤出设置界面 &gt; mian &gt; font &gt; monospce,去掉那勾勾即可。</p>
</li>
</ul>
<h2 id="cmder常用快捷键">Cmder常用快捷键</h2>
<ul>
<li>跟一般浏览器页签操作习惯一致：</li>
<li>可以利用Tab，自动路径补全(爽,赞！)；</li>
<li>可以利用Ctrl+T建立新页签；</li>
<li>利用Ctrl+W关闭页签;</li>
<li>还可以透过Ctrl+Tab切换页签;</li>
<li>Alt+F4：关闭所有页签</li>
<li>Alt+Shift+1：开启cmd.exe</li>
<li>Alt+Shift+2：开启powershell.exe</li>
<li>Alt+Shift+3：开启powershell.exe (系统管理员权限)</li>
<li>Ctrl+1：快速切换到第1个页签</li>
<li>Ctrl+n：快速切换到第n个页签( n值无上限)</li>
<li>Alt + enter：切换到全屏状态；</li>
<li>Ctr+r：历史命令搜索;</li>
<li>End, Home, Ctrl：Traversing text with as usual on Windows</li>
</ul>
<h2 id="其他功能">其他功能</h2>
<ul>
<li>Cmder还增加了alias功能；他让你用短短的指令执行一些常见但指令超长又难以记忆的语法；比如 ls cls等等；在其控制台输入alias可以查看（新版本已废除）。</li>
<li>主控台文字自动放大缩小功能，你只要按下Ctrl+滑鼠滚轮就可以办到；如果你用支援两点触控的笔电，也可以在触控板上用两指放大的手势调整文字大小。还有：up，向上翻历史命令;</li>
<li>Cmder有极为简单的复制粘贴操作。Ctr+V直接粘贴；用鼠标选中你想拷贝的内容，自动就复制到剪切板；</li>
<li>自定义aliases：打开Cmder目录下的config文件夹，里面的<code>user-aliases.cmd</code>文件就是我们可以配置的别名文件。
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="line"><span class="cl">l=ls --show-control-chars -alrtF --color $*</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="问题及解决">问题及解决</h2>
<h3 id="问题一中文乱码">问题一：中文乱码</h3>
<p>一般的乱码在加了下边的软件环境变量后都可以解决，在<code>Settings &gt; Startup &gt; Environment</code>中添加：</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set LC_ALL=zh_CN.UTF8</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="问题二git-status-显示中文乱码">问题二：git status 显示中文乱码</h3>
<p>场景：在中文情况下<code>Git status</code>是这样的:</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Your branch is up-to-date with &#39;origin/master&#39;.
</span></span><span class="line"><span class="cl">Changes not staged for commit:
</span></span><span class="line"><span class="cl">  (use &#34;git add &lt;file&gt;...&#34; to update what will be committed)
</span></span><span class="line"><span class="cl">  (use &#34;git checkout -- &lt;file&gt;...&#34; to discard changes in working directory)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    modified:   &#34;\345\274\200\351\242\230\346\212\245\345\221\212/\345\267\245\347\250\213\347\241\225\345\243\253\347\240\224\347\251\266\347\224\237\345\255\246\344\275\215\350\256\272\346\226\207\345\274\200\351\242\230\346\212\245\345\221\212\342\200\224\346\235\250\345\263\273\351\271\217.doc&#34;</span></span></code></pre></td></tr></table>
</div>
</div><p>解决方法：</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git config --global core.quotepath false</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="参考资料">参考资料</h2>
<ul>
<li>《Cmder&ndash;Windows下命令行利器》：http://www.cnblogs.com/zqzjs/p/6188605.html</li>
<li>《Win下必备神器之Cmder》：https://segmentfault.com/a/1190000004408436</li>
<li>《Windows 命令行增强 cmder chocolatey 配置指南》：http://www.jianshu.com/p/479d974078a7</li>
</ul>]]></description></item><item><title>Sublime Text - 个人认为最好用的文本编辑器</title><link>https://blog.iqzhi.com/posts/sublime-text/</link><pubDate>Tue, 05 Sep 2017 21:17:47 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/sublime-text/</guid><description><![CDATA[<p>跨平台的文本编辑器。</p>
<h2 id="简介">简介</h2>
<p><a href="http://www.sublimetext.com/"target="_blank" rel="external nofollow noopener noreferrer">Sublime Text</a>是付费软件，但非常之良心，只是偶尔弹出提示购买，并没有任何功能限制。作为一个跨平台的文本编辑器，支持基于Python的插件。可通过包（Package）扩充本身的功能。大多数的包使用自由软件授权发布，并由社区建置维护。</p>
<p>虽然Sublime Text 3一直在Beta，但很多插件已经开始放弃支持ST2了，所以推荐使用ST3。</p>
<ul>
<li>
<p>下载地址戳这里：http://www.sublimetext.com/3</p>
</li>
<li>
<p>3143可用<code>Sublime Text</code>许可证一枚</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">----- BEGIN LICENSE -----
</span></span><span class="line"><span class="cl">TwitterInc
</span></span><span class="line"><span class="cl">200 User License
</span></span><span class="line"><span class="cl">EA7E-890007
</span></span><span class="line"><span class="cl">1D77F72E 390CDD93 4DCBA022 FAF60790
</span></span><span class="line"><span class="cl">61AA12C0 A37081C5 D0316412 4584D136
</span></span><span class="line"><span class="cl">94D7F7D4 95BC8C1C 527DA828 560BB037
</span></span><span class="line"><span class="cl">D1EDDD8C AE7B379F 50C9D69D B35179EF
</span></span><span class="line"><span class="cl">2FE898C4 8E4277A8 555CE714 E1FB0E43
</span></span><span class="line"><span class="cl">D5D52613 C3D12E98 BC49967F 7652EED2
</span></span><span class="line"><span class="cl">9D2D2E61 67610860 6D338B72 5CF95C69
</span></span><span class="line"><span class="cl">E36B85CC 84991F19 7575D828 470A92AB
</span></span><span class="line"><span class="cl">------ END LICENSE ------</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>3126可用<code>Sublime Text</code>许可证一枚</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">—– BEGIN LICENSE —–
</span></span><span class="line"><span class="cl">Michael Barnes
</span></span><span class="line"><span class="cl">Single User License
</span></span><span class="line"><span class="cl">EA7E-821385
</span></span><span class="line"><span class="cl">8A353C41 872A0D5C DF9B2950 AFF6F667
</span></span><span class="line"><span class="cl">C458EA6D 8EA3C286 98D1D650 131A97AB
</span></span><span class="line"><span class="cl">AA919AEC EF20E143 B361B1E7 4C8B7F04
</span></span><span class="line"><span class="cl">B085E65E 2F5F5360 8489D422 FB8FC1AA
</span></span><span class="line"><span class="cl">93F6323C FD7F7544 3F39C318 D95E6480
</span></span><span class="line"><span class="cl">FCCC7561 8A4A1741 68FA4223 ADCEDE07
</span></span><span class="line"><span class="cl">200C25BE DBBC4855 C4CFB774 C5EC138C
</span></span><span class="line"><span class="cl">0FEC1CEF D9DCECEC D3A5DAD1 01316C36
</span></span><span class="line"><span class="cl">—— END LICENSE ——</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="定制配置">定制配置</h2>
<p>正所谓，没有插件的编辑器不是好的美工刀。
要有一把顺手的美工刀，总少不了定（调）制（教）。</p>
<ol>
<li>
<p>安装插件管理器
<strong>ctrl+`</strong> 打开调试窗口，在输入框内粘贴如下代码，然后回车即可自动安装，安装完成可能需要重启ST。</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import urllib.request,os,hashlib; h = &#39;2915d1851351e5ee549c20394736b442&#39; + &#39;8bc59f460fa1548d1514676163dafc88&#39;; pf =     &#39;Package Control.sublime-package&#39;; ipp = sublime.installed_packages_path(); urllib.request.install_opener(  urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( &#39;http:// packagecontrol.io/&#39; + pf.replace(&#39; &#39;, &#39;%20&#39;)).read(); dh = hashlib.sha256(by).hexdigest(); print(&#39;Error validating   download (got %s instead of %s), please try manual install&#39; % (dh, h)) if dh != h else open(os.path.join( ipp, pf),   &#39;wb&#39; ).write(by)</span></span></code></pre></td></tr></table>
</div>
</div><p>使用方法：工具栏 Preferences – Package Control，或者 ctrl+shift+P ，插件的安装卸载都可以在这里操作。
如何安装插件详见：https://packagecontrol.io/installation</p>
</li>
<li>
<p>推荐安装的插件列表</p>
<p>易用性：
ChineseLocalization：完全汉化插件
HTML5：HTML5标签拓展
JsFormat：javascript格式化
CSS Format：CSS格式化
Tag：HTML格式化
<a href="https://packagecontrol.io/packages/BracketHighlighter"target="_blank" rel="external nofollow noopener noreferrer">Brackethighlighter</a>：标签对标记，以高亮显示配对括号以及当前光标所在区域
SideBarEnhancements：增强型侧边栏
BufferScroll：代码折叠状态保留
StyleToken：标记颜色代码
<a href="https://packagecontrol.io/packages/AutoPEP8"target="_blank" rel="external nofollow noopener noreferrer">AutoPEP8</a>：格式化Python代码。
<a href="https://packagecontrol.io/packages/Alignment"target="_blank" rel="external nofollow noopener noreferrer">Alignment</a>：进行智能对齐</p>
<p>功能：
<a href="https://packagecontrol.io/packages/MarkdownEditing"target="_blank" rel="external nofollow noopener noreferrer">Markdown Editing</a>：支持Markdown语法高亮；支持Github Favored Markdown语法；自带3个主题。本篇文章就是在此插件下完成
Emmet：前端神器
TortoiseSVN：SVN你懂的
QuoteHTML：把HTML拼接成js插入字符串，神器
Clipboard Manager：增强型剪贴板，可访问历史剪贴板记录
FileHeader：文件模板，可自动更新修改时间
AutoPrefixer：浏览器私有属性前缀补全 (Node.js依赖)
ColorConvert：RGBA颜色转换，十六进制颜色转换为RGBA颜色
Better Completion：全能代码提示
LiveStyle：双向更改无刷新实时预览，包含chrome插件 Emmet LiveStyle
SFTP：需要激活，看这里 <a href="http://mooring.iteye.com/blog/2067269"target="_blank" rel="external nofollow noopener noreferrer">http://mooring.iteye.com/blog/2067269</a>
jQuery：jQuery 代码提示（Better Completion已可替代此插件）</p>
<p>其他：
<a href="https://packagecontrol.io/packages/ConvertToUTF8"target="_blank" rel="external nofollow noopener noreferrer">ConvertToUTF8</a>：GBK编码兼容
<a href="https://packagecontrol.io/packages/IMESupport"target="_blank" rel="external nofollow noopener noreferrer">IMESupport</a>：输入法不跟随时安装
TrailingSpaces：多余空格标记，强迫症患者福音
Hasher：符号转义，ctrl+shift+p 选择 Entity Encode
PackageResourceViewer：插件修改必备，ctrl+shift+p 调用 Open Resource</p>
</li>
<li>
<p>用户配置文件设置
工具栏 Preferences – Settings-User 加入下面的代码：</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="o">//</span><span class="w"> </span><span class="err">使光标更柔和</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;caret_style&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;phase&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">自动移除行尾多余空格</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;trim_trailing_white_space_on_save&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">文件末尾自动保留一个空行</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;ensure_newline_at_eof_on_save&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">设置字体，推荐可以尝试</span><span class="w"> </span><span class="n">Yahei</span><span class="w"> </span><span class="n">Consolas</span><span class="w"> </span><span class="n">Hybrid</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;font_face&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;Microsoft Yahei UI&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">设置字体大小</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;font_size&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">设置为</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="err">，禁用</span><span class="w"> </span><span class="n">Emmet</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="err">键功能（请使用</span><span class="w"> </span><span class="n">ctrl</span><span class="o">+</span><span class="n">e</span><span class="err">），系统自带的</span><span class="o">`</span><span class="n">tab</span><span class="o">`</span><span class="w">  </span><span class="err">功能还是可圈可点的。当然也可以不设置它，以完全使用</span><span class="w"> </span><span class="n">Emmet</span><span class="w"> </span><span class="err">的</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="err">补全功能</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;disable_tab_abbreviations&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">把代码</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="err">对齐转换为空格对齐</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;translate_tabs_to_spaces&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">配合设置空格数</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;tab_size&#34;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">用于右侧代码预览时给所在区域加上边框，方便识别</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;draw_minimap_border&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">窗口失焦立即保存文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;save_on_focus_lost&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">当前行高亮</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;highlight_line&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">设置自动换行</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;word_wrap&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">默认显示行号右侧的代码段闭合展开三角号</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;fade_fold_buttons&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">侧边栏文件夹显示加粗，区别于文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;bold_folder_labels&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">高亮未保存文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;highlight_modified_tabs&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">使用</span><span class="w"> </span><span class="n">unix</span><span class="w"> </span><span class="err">风格的换行符</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;default_line_ending&#34;</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;unix&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">//</span><span class="w"> </span><span class="err">开启选中范围内搜索，而不是整个文档</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="s2">&#34;auto_find_in_selection&#34;</span><span class="p">:</span><span class="w"> </span><span class="no">true</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Windows系统将Sublime Text 添加到鼠标右键功能：
把以下内容复制并保存到文件，重命名为：sublime_addright.reg，然后双击就可以了。</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-reg" data-lang="reg"><span class="line"><span class="cl">Windows Registry Editor Version 5.00
</span></span><span class="line"><span class="cl"><span class="k">[</span><span class="nb">HKEY_CLASSES_ROOT</span><span class="k">\*\shell\SublimeText3]</span>
</span></span><span class="line"><span class="cl"><span class="na">@</span><span class="o">=</span><span class="s">&#34;Edit with Sublime Text3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">&#34;Icon&#34;</span><span class="o">=</span><span class="s">&#34;C:\\Program Files\\Sublime Text 3\\sublime_text.exe,0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">[</span><span class="nb">HKEY_CLASSES_ROOT</span><span class="k">\*\shell\SublimeText3\command]</span>
</span></span><span class="line"><span class="cl"><span class="na">@</span><span class="o">=</span><span class="s">&#34;C:\\Program Files\\Sublime Text 3\\sublime_text.exe %1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">[</span><span class="nb">HKEY_CLASSES_ROOT</span><span class="k">\Directory\shell\SublimeText3]</span>
</span></span><span class="line"><span class="cl"><span class="na">@</span><span class="o">=</span><span class="s">&#34;Edit with Sublime Text3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="na">&#34;Icon&#34;</span><span class="o">=</span><span class="s">&#34;C:\\Program Files\\Sublime Text 3\\sublime_text.exe,0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">[</span><span class="nb">HKEY_CLASSES_ROOT</span><span class="k">\Directory\shell\SublimeText3\command]</span>
</span></span><span class="line"><span class="cl"><span class="na">@</span><span class="o">=</span><span class="s">&#34;C:\\Program Files\\Sublime Text 3\\sublime_text.exe %1&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>注意：</p>
<ol>
<li>需要把代码中的Sublime的安装目录（C:\Program Files\Sublime Text 3\sublime_text.exe），替换成自已实际的Sublime安装目录。</li>
<li>其中，@=&ldquo;Edit with Sublime Text3&rdquo; 引号中的内容为出现在鼠标右键菜单中的文字内容。</li>
</ol>
</li>
</ol>
<h2 id="使用技巧">使用技巧</h2>
<h3 id="代码段code-snippets">代码段（Code Snippets）</h3>
<p>Sublime Text 支持代码段（Code Snippet），输入代码段名称后 Tab 即可生成代码段。
可以通过Package Control安装第三方代码段，也可以自己创建代码段，参考<a href="http://www.hongkiat.com/blog/sublime-code-snippets/"target="_blank" rel="external nofollow noopener noreferrer">这里</a></p>
<h3 id="全屏full-screen">全屏（Full Screen）</h3>
<p>Sublime Text 有两种全屏模式：普通全屏和无干扰全屏。
个人强烈建议在开启全屏前关闭菜单栏（Toggle Menu），否则全屏效果会大打折扣。</p>
<p><code>F11</code> 切换普通全屏
<code>Shift + F11</code> 切换无干扰全屏</p>
<h3 id="格式化formatting">格式化（Formatting）</h3>
<p>Sublime Text 基本的手动格式化操作包括： <code>Ctrl + [</code> 向左缩进， <code>Ctrl + ]</code> 向右缩进，此外 <code>Ctrl + Shift + V</code> 可以以当前缩进粘贴代码（非常实用）。</p>
<h3 id="快捷键列表shortcuts-cheatsheet">快捷键列表（Shortcuts Cheatsheet）</h3>
<p>我把本文出现的Sublime Text按其类型整理在这里，以便查阅。</p>
<h4 id="通用general">通用（General）</h4>
<ul>
<li><code>↑↓←→</code>：上下左右移动光标，注意不是不是 KJHL ！</li>
<li><code>Alt</code>：调出菜单</li>
<li><code>Ctrl + Shift + P</code>：调出命令板（Command Palette）</li>
<li><strong>Ctrl + `</strong>：调出控制台</li>
</ul>
<h4 id="编辑editing">编辑（Editing）</h4>
<ul>
<li><code>Ctrl + Enter</code>：在当前行下面新增一行然后跳至该行</li>
<li><code>Ctrl + Shift + Enter</code>：在当前行上面增加一行并跳至该行</li>
<li><code>Ctrl + ←/→</code>：进行逐词移动</li>
<li><code>Ctrl + Shift + ←/→</code>：进行逐词选择</li>
<li><code>Ctrl + ↑/↓</code>：移动当前显示区域</li>
<li><code>Ctrl + Shift + ↑/↓</code>：移动当前行</li>
</ul>
<h4 id="选择selecting">选择（Selecting）</h4>
<ul>
<li><code>Ctrl + D</code>：选择当前光标所在的词并高亮该词所有出现的位置，再次 <code>Ctrl + D</code> 选择该词出现的下一个位置，在多重选词的过程中，使用 <code>Ctrl + K</code> 进行跳过，使用 <code>Ctrl + U</code> 进行回退，使用 <code>Esc</code> 退出多重编辑</li>
<li><code>Ctrl + Shift + L</code>：将当前选中区域打散</li>
<li><code>Ctrl + J</code>：把当前选中区域合并为一行</li>
<li><code>Ctrl + M</code>：在起始括号和结尾括号间切换</li>
<li><code>Ctrl + Shift + M</code>：快速选择括号间的内容</li>
<li><code>Ctrl + Shift + J</code>：快速选择同缩进的内容</li>
<li><code>Ctrl + Shift + Space</code>：快速选择当前作用域（Scope）的内容</li>
</ul>
<h4 id="查找替换findingreplacing">查找&amp;替换（Finding&amp;Replacing）</h4>
<ul>
<li><code>F3</code>：跳至当前关键字下一个位置</li>
<li><code>Shift + F3</code>：跳到当前关键字上一个位置</li>
<li><code>Alt + F3</code>：选中当前关键字出现的所有位置</li>
<li><code>Ctrl + F/H</code>：进行标准查找/替换，之后：</li>
<li><code>Alt + C</code>：切换大小写敏感（Case-sensitive）模式</li>
<li><code>Alt + W</code>：切换整字匹配（Whole matching）模式</li>
<li><code>Alt + R</code>：切换正则匹配（Regex matching）模式</li>
<li><code>Ctrl + Shift + H</code>：替换当前关键字</li>
<li><code>Ctrl + Alt + Enter</code>：替换所有关键字匹配</li>
<li><code>Ctrl + Shift + F</code>：多文件搜索&amp;替换</li>
</ul>
<h4 id="跳转jumping">跳转（Jumping）</h4>
<ul>
<li><code>Ctrl + P</code>：跳转到指定文件，输入文件名后可以：
<ul>
<li><code>@</code> 符号跳转：输入 @symbol 跳转到 symbol 符号所在的位置</li>
<li><code>#</code> 关键字跳转：输入 #keyword 跳转到 keyword 所在的位置</li>
<li><code>:</code> 行号跳转：输入 :12 跳转到文件的第12行。</li>
</ul>
</li>
<li><code>Ctrl + R</code>：跳转到指定符号</li>
<li><code>Ctrl + G</code>：跳转到指定行号</li>
</ul>
<h4 id="窗口window">窗口（Window）</h4>
<ul>
<li><code>Ctrl + Shift + N</code>：创建一个新窗口</li>
<li><code>Ctrl + N</code>：在当前窗口创建一个新标签</li>
<li><code>Ctrl + W</code>：关闭当前标签，当窗口内没有标签时会关闭该窗口</li>
<li><code>Ctrl + Shift + T</code>：恢复刚刚关闭的标签</li>
</ul>
<h4 id="屏幕screen">屏幕（Screen）</h4>
<ul>
<li><code>F11</code>：切换普通全屏</li>
<li><code>Shift + F11</code>：切换无干扰全屏</li>
<li><code>Alt + Shift + 2</code>：进行左右分屏</li>
<li><code>Alt + Shift + 8</code>：进行上下分屏</li>
<li><code>Alt + Shift + 5</code>：进行上下左右分屏</li>
<li>分屏之后，使用 <code>Ctrl + 数字键</code> 跳转到指定屏，使用 <code>Ctrl + Shift + 数字键</code> 将当前屏移动到指定屏。例如， <code>Ctrl + 1</code> 会跳转到1屏，而 <code>Ctrl + Shift + 2</code> 会将当前屏移动到2屏。</li>
</ul>
<h2 id="常用插件">常用插件</h2>
<ul>
<li><a href="https://packagecontrol.io/packages/MarkdownEditing"target="_blank" rel="external nofollow noopener noreferrer">Markdown Editing</a>
<ul>
<li>
<p>常用快捷键（Key Bindings）
<code>Ctrl + 1...6</code> 1至6级标题
<code>Ctrl + Win + V</code> 或 <code>Ctrl + Win + R</code> 插入链接
<code>Shift + Win + K</code> 插入图片
<code>Alt + Shift + 6</code> 插入标注</p>
</li>
<li>
<p>代码段（Code Snippet）
输入 <code>mdl + tab</code> 会自动生成下面的链接标记</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[](link)</span></span></code></pre></td></tr></table>
</div>
</div><p>输入 <code>mdi + tab</code> 会自动插入下面的图片标记</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">![Alt text](/path/to/img.jpg &#34;Optional title&#34;)</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ul>
<li>官方文档：http://www.sublimetext.com/docs/3/</li>
<li>官方论坛：http://www.sublimetext.com/forum/</li>
<li>Package Control：https://packagecontrol.io/  大量的 Sublime Text 插件和主题。</li>
<li>《Sublime Text 全程指南》：http://zh.lucida.me/blog/sublime-text-complete-guide/</li>
<li>《Sublime Text：学习资源篇》：http://www.jianshu.com/p/d1b9a64e2e37</li>
</ul>]]></description></item><item><title>Hexo - 借助GitHub搭建个人博客</title><link>https://blog.iqzhi.com/posts/build-hexo/</link><pubDate>Fri, 29 Apr 2016 15:39:20 +0800</pubDate><author>枫</author><guid>https://blog.iqzhi.com/posts/build-hexo/</guid><description><![CDATA[<p>Hexo静态博客框架。</p>
<h2 id="前言">前言</h2>
<p><code>2017-09-05更新</code> 一年多后，由于不再在封闭环境及云桌面办公，所以把Hexo得重新启用，打算用来做技术博客，或者叫Wiki，写一些自己的技术总结，按此前搭建的记录，部署起来。</p>
<p>有些日子没玩博客了，其实以前也一直很少去输出一些什么，但就是喜欢有一个属于个人的地方，向互联网展示一下自己的存在感！
I&rsquo;m here，嗯，是这个意思！
以前和网友一起合租过服务器，也在Godady买过域名，但最后还是没坚持下来，后来折腾完之后，最实用的反而是搭梯翻墙而已。
好了，再多的就不扯了，这篇就是为了记录下在Windows下用Hexo在GitHub上搭建个人博客的过程，希望可以对其他朋友有所帮助。</p>
<h2 id="简介">简介</h2>
<h3 id="hexo是什么">Hexo是什么？</h3>
<p>Hexo是一个很好的开源静态博客生成器，基于Node.js开发，作者是台湾大学生tommy351。
Hexo依赖于Git与Node.js环境，就是说，你要玩Hexo，就必须先得把环境搭好，才能一起玩耍！</p>
<h2 id="环境搭建">环境搭建</h2>
<p>在Windows上装Git和Node.js都没什么好说的，和其它正常软件是一样的，就是下个安装包，双击打开，无脑下一步，默认选项即可，就完成了，下边附上下载包链接：</p>
<h3 id="安装git">安装Git</h3>
<p><a href="https://git-scm.com/" title="git-scm"target="_blank" rel="external nofollow noopener noreferrer">https://git-scm.com/</a></p>
<h3 id="安装nodejs">安装Node.js</h3>
<p><a href="https://nodejs.org/" title="Node.js"target="_blank" rel="external nofollow noopener noreferrer">https://nodejs.org/</a>
说明一下，下的是V6.11.2 LTS，长期支持版，而非最新的V8.4.0；非前端开发，没必要安装最新版。</p>
<h3 id="安装hexo">安装Hexo</h3>
<p>正主来了，这个开始就要学会使用Git Bash来运行了！
如果安装的时候选择了集成到Windows的CMD中，打开CMD运行也是可行的。
带上了参数-g就是全局安装，所以不用纠结是在哪个目录下运行命令。</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm install hexo-cli -g</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="初始化若非首次安装不需要">初始化（若非首次安装，不需要）</h4>
<p>初始化有2种方式，下边以blog文件夹为例，初始化完还需要在文件夹里安装包依赖：</p>
<ol>
<li>
<p>直接指定目录</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ hexo init blog</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>进入指定目录</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">cd</span> blog
</span></span><span class="line"><span class="cl">$ hexo init</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>终端执行命令后显示的结果：</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[info] Copying data[info] You are almost done! Don&#39;t forget to run `npm install` before start blogging with Hexo!</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="依赖安装">依赖安装</h4>
<ul>
<li>
<p>安装包依赖</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">cd</span> blog
</span></span><span class="line"><span class="cl">$ npm install</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="部署">部署</h2>
<ul>
<li>
<p>生成静态文件</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ hexo generate</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>启动本地调试环境</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ hexo server</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>至此，本地的环境算是完工了，你可以访问<code>http://localhost:4000</code>查看你的页面了！</p>
<h2 id="定制配置">定制配置</h2>
<ul>
<li>
<p>在Hexo 3.0版本后<code>deploy-git</code><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>被分开的，所以需要安装，安装命令如下：</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm install hexo-deployer-git --save</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>增加RSS订阅<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>，需要安装，命令如下：</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm install hexo-generator-feed --save</span></span></code></pre></td></tr></table>
</div>
</div><p>站点配置文件<code>_config.yml</code>增加配置如下：</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># Feed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">feed</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">atom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">atom.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">limit</span><span class="p">:</span><span class="w"> </span><span class="m">20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">hub:</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>GitHub Pages 自定义404页面非常容易，直接在source根目录下创建自己的404.html就可以，代码如下：</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE HTML&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;content-type&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;text/html;charset=utf-8;&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge,chrome=1&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;robots&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;all&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;robots&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;index,follow&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;http://www.qq.com/404/search_children.js&#34;</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span> <span class="na">homePageUrl</span><span class="o">=</span><span class="s">&#34;http://qiuzhi.github.io/&#34;</span> <span class="na">homePageName</span><span class="o">=</span><span class="s">&#34;回到我的主页&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>增加<a href="https://disqus.com/"target="_blank" rel="external nofollow noopener noreferrer">disqus</a>评论</p>
<ol>
<li>到官网注册并配置账号，得到shortname</li>
<li>在主题配置文件<code>_config.yml</code>相应位置修改如下：</li>
</ol>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># Disqus</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">disqus</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enable</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">shortname</span><span class="p">:</span><span class="w"> </span><span class="l">shortname</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">count</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>文章链接唯一化
也许你会数次更改文章题目或者变更文章发布时间，在默认设置下，文章链接都会改变，不利于搜索引擎收录，也不利于分享。唯一永久链接才是更好的选择。</p>
<p>安装</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">npm install hexo-abbrlink --save</span></span></code></pre></td></tr></table>
</div>
</div><p>在站点配置文件中查找代码permalink，将其更改为:</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">permalink: posts/:abbrlink/  # “posts/” 可自行更换</span></span></code></pre></td></tr></table>
</div>
</div><p>这里有个知识点：
百度蜘蛛抓取网页的规则: 对于蜘蛛说网页权重越高、信用度越高抓取越频繁，例如网站的首页和内页。蜘蛛先抓取网站的首页，因为首页权重更高，并且大部分的链接都是指向首页。然后通过首页抓取网站的内页，并不是所有内页蜘蛛都会去抓取。</p>
<p>搜索引擎认为对于一般的中小型站点，3层足够承受所有的内容了，所以蜘蛛经常抓取的内容是前三层，而超过三层的内容蜘蛛认为那些内容并不重要，所以不经常爬取。出于这个原因所以permalink后面跟着的最好不要超过2个斜杠。</p>
<p>然后在站点配置文件中添加如下代码:</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># abbrlink config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">abbrlink</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">alg</span><span class="p">:</span><span class="w"> </span><span class="l">crc32 </span><span class="w"> </span><span class="c"># 算法：crc16(default) and crc32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rep</span><span class="p">:</span><span class="w"> </span><span class="l">hex   </span><span class="w"> </span><span class="c"># 进制：dec(default) and hex</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可选择模式：
crc16 &amp; hex
crc16 &amp; dec
crc32 &amp; hex
crc32 &amp; dec</p>
<p>可参照样例以选择：</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">crc16 &amp; hex
</span></span><span class="line"><span class="cl">https://post.zz173.com/posts/66c8.html
</span></span><span class="line"><span class="cl">crc16 &amp; dec
</span></span><span class="line"><span class="cl">https://post.zz173.com/posts/65535.html
</span></span><span class="line"><span class="cl">crc32 &amp; hex
</span></span><span class="line"><span class="cl">https://post.zz173.com/posts/8ddf18fb.html
</span></span><span class="line"><span class="cl">crc32 &amp; dec
</span></span><span class="line"><span class="cl">https://post.zz173.com/posts/1690090958.html</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="发布到互联网">发布到互联网</h2>
<ol>
<li>
<p>到<a href="https://github.com/" title="GitHub"target="_blank" rel="external nofollow noopener noreferrer">GitHub</a>注册
新建repository(仓库)，填写格式如下图所示: [yourusername].github.io
将[yourusername]换成你在GitHub注册的用户名！</p>
</li>
<li>
<p>生成SSH Keys
如何让本地git项目与远程的github建立联系？需要用到SSH Keys！</p>
<ol>
<li>使用ssh-keygen命令生成密钥对</li>
</ol>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh-keygen -t rsa -C <span class="s2">&#34;这里是你申请Github账号时的邮箱&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>然后系统会要你输入密码：（我们输入的密码会在你提交项目的时候使用）</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Enter passphrase <span class="o">(</span>emptyforno passphrase<span class="o">)</span>:&lt;输入加密串&gt;
</span></span><span class="line"><span class="cl">Enter same passphrase again:&lt;再次输入加密串&gt;</span></span></code></pre></td></tr></table>
</div>
</div><p>从终端提示生成的文件路径中找到你生成的密钥找到<code>id_rsa.pub</code>用终端进入编辑，复制密钥。</p>
<ol>
<li>添加SSH Key到GitHub
登陆GitHub网站，找到<a href="https://github.com/settings/keys"target="_blank" rel="external nofollow noopener noreferrer">Setting-SSH and GPG keys</a>，点击<code>New SSH key</code>按钮，将复制的密钥粘贴到<code>Key</code>栏；<code>Title</code>栏填上你喜欢的标识随意标记，然后保存即可。</li>
<li>验证SSH是否链通</li>
</ol>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh -T git@github.com</span></span></code></pre></td></tr></table>
</div>
</div><p>终端执行命令后显示的结果：</p>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Hi xxx! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</span></span></code></pre></td></tr></table>
</div>
</div><p>现在就已经可以通过SSH链接到Github了！</p>
<ol>
<li>别忘记设置提交信息</li>
</ol>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ git config --global user.name <span class="s2">&#34;xxx&#34;</span>
</span></span><span class="line"><span class="cl">$ git config --global user.email <span class="s2">&#34;xxx@xxx.com&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>打开站点配置文件，Hexo根目录下_config.yml：</p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="c"># Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">## Docs: https://hexo.io/docs/deployment.html</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">deploy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">git</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/<sup>yourusername</sup>/<sub>yourusername</sub>.github.io.git</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">branch</span><span class="p">:</span><span class="w"> </span><span class="l">master</span></span></span></code></pre></td></tr></table>
</div>
</div><p>将[yourusername]换成你在GitHub注册的用户名！</p>
</li>
<li>
<p>发布到Github</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ hexo deploy</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<p>至此，GitHub的环境算是完工了，你可以访问<code>http://[yourusername].github.io</code>查看你的页面了！</p>
<h2 id="维护">维护</h2>
<h3 id="环境信息">环境信息</h3>
<ul>
<li>
<p>查看node.js的版本</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ node -v
</span></span><span class="line"><span class="cl">v6.11.2</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看node.js的版本</p>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm ls --depth <span class="m">0</span>
</span></span><span class="line"><span class="cl">hexo-site@0.0.0 <span class="se">\H</span>exo
</span></span><span class="line"><span class="cl">├── hexo@3.3.8
</span></span><span class="line"><span class="cl">├── hexo-deployer-git@0.1.0
</span></span><span class="line"><span class="cl">├── hexo-generator-archive@0.1.4
</span></span><span class="line"><span class="cl">├── hexo-generator-category@0.1.3
</span></span><span class="line"><span class="cl">├── hexo-generator-feed@1.2.0
</span></span><span class="line"><span class="cl">├── hexo-generator-index@0.2.1
</span></span><span class="line"><span class="cl">├── hexo-generator-tag@0.2.0
</span></span><span class="line"><span class="cl">├── hexo-renderer-ejs@0.2.0
</span></span><span class="line"><span class="cl">├── hexo-renderer-marked@0.2.11
</span></span><span class="line"><span class="cl">├── hexo-renderer-stylus@0.3.3
</span></span><span class="line"><span class="cl">├── hexo-server@0.2.2
</span></span><span class="line"><span class="cl">└── hexo-util@0.6.1</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="依赖更新">依赖更新</h3>
<p>在hexo site（<code>_config.yml</code>及<code>package.json</code>的资料夹）下</p>
<ul>
<li>
<p>查看是否存在新旧版本</p>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm outdated</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>更新版本</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm update -S</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>更多请参考 <a href="https://docs.npmjs.com/"target="_blank" rel="external nofollow noopener noreferrer">npm文档</a> 及 <a href="https://hexo.io/docs/"target="_blank" rel="external nofollow noopener noreferrer">hexo文档</a></p>
<h2 id="过程中遇到的问题及解决">过程中遇到的问题及解决</h2>
<h3 id="问题一cannot-find-module-hexo-util">问题一：Cannot find module &lsquo;hexo-util&rsquo;</h3>
<ul>
<li>问题描述：</li>
</ul>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ERROR Script load failed: themes/hexo-theme-next/scripts/tags/exturl.js  
</span></span><span class="line"><span class="cl">Error: Cannot find module <span class="s1">&#39;hexo-util&#39;</span>  
</span></span><span class="line"><span class="cl">    at Function.Module._resolveFilename <span class="o">(</span>module.js:336:15<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Function.Module._load <span class="o">(</span>module.js:286:25<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Module.require <span class="o">(</span>module.js:365:17<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at require <span class="o">(</span>/data/github/hexo/node_modules/hexo/lib/hexo/index.js:213:21<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at /data/github/hexo/themes/hexo-theme-next/scripts/tags/exturl.js:7:12  
</span></span><span class="line"><span class="cl">    at /data/github/hexo/node_modules/hexo/lib/hexo/index.js:229:12  
</span></span><span class="line"><span class="cl">    at tryCatcher <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/util.js:16:23<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromiseFromHandler <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:512:31<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromise <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:569:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromise0 <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:614:10<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromises <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:693:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._fulfill <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:638:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._resolveCallback <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:432:57<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromiseFromHandler <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:524:17<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromise <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:569:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromise0 <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:614:10<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._settlePromises <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:693:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at Promise._fulfill <span class="o">(</span>/data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/promise.js:638:18<span class="o">)</span>  
</span></span><span class="line"><span class="cl">    at /data/github/hexo/node_modules/hexo/node_modules/bluebird/js/release/nodeback.js:42:21  
</span></span><span class="line"><span class="cl">    at /data/github/hexo/node_modules/hexo/node_modules/hexo-fs/node_modules/graceful-fs/graceful-fs.js:78:16  
</span></span><span class="line"><span class="cl">    at FSReqWrap.readFileAfterClose <span class="o">[</span>as oncomplete<span class="o">]</span> <span class="o">(</span>fs.js:380:3<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>解决方案
提示hexo-util找不到, 执行下面命令后就可以了</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ npm install hexo-util --save</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="问题二could-not-read-username-for-httpsgithubcom-invalid-argument">问题二：could not read Username for &lsquo;<a href="https://github.com"target="_blank" rel="external nofollow noopener noreferrer">https://github.com</a>&rsquo;: Invalid argument</h3>
<ul>
<li>问题描述：Windows下更换Comder作为CMD终端后，遇到</li>
</ul>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nothing to commit, working tree clean
</span></span><span class="line"><span class="cl">bash: /dev/tty: No such device or address
</span></span><span class="line"><span class="cl">error: failed to execute prompt script <span class="o">(</span><span class="nb">exit</span> code 1<span class="o">)</span>
</span></span><span class="line"><span class="cl">fatal: could not <span class="nb">read</span> Username <span class="k">for</span> <span class="s1">&#39;https://github.com&#39;</span>: Invalid argument
</span></span><span class="line"><span class="cl">FATAL Something<span class="s1">&#39;s wrong. Maybe you can find the solution here: http://hexo.io/docs/troubleshooting.html
</span></span></span><span class="line"><span class="cl"><span class="s1">Error: bash: /dev/tty: No such device or address
</span></span></span><span class="line"><span class="cl"><span class="s1">error: failed to execute prompt script (exit code 1)
</span></span></span><span class="line"><span class="cl"><span class="s1">fatal: could not read Username for &#39;</span>https://github.com<span class="err">&#39;</span>: Invalid argument
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    at ChildProcess.&lt;anonymous&gt; <span class="o">(</span>E:<span class="se">\D</span>ropbox<span class="se">\H</span>exo<span class="se">\n</span>ode_modules<span class="se">\h</span>exo-util<span class="se">\l</span>ib<span class="se">\s</span>pawn.js:37:17<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at emitTwo <span class="o">(</span>events.js:106:13<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at ChildProcess.emit <span class="o">(</span>events.js:191:7<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at ChildProcess.cp.emit <span class="o">(</span>E:<span class="se">\D</span>ropbox<span class="se">\H</span>exo<span class="se">\n</span>ode_modules<span class="se">\c</span>ross-spawn<span class="se">\l</span>ib<span class="se">\e</span>noent.js:40:29<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at maybeClose <span class="o">(</span>internal/child_process.js:891:16<span class="o">)</span>
</span></span><span class="line"><span class="cl">    at Process.ChildProcess._handle.onexit <span class="o">(</span>internal/child_process.js:226:5<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>解决方案
由于新手还不明白运行的机制，使用了Cmder自带的git工具，好像只能走ssh通道去更新。进行下边两步即可</p>
<ol>
<li>那就先把hexo根目录下.deploy_git目录删除</li>
<li>修改_config.yml文件：</li>
</ol>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l">https://github.com/username/username.github.io.git</span></span></span></code></pre></td></tr></table>
</div>
</div><p>修改为</p>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l">git@github.com:username/username.github.io.git</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://github.com/hexojs/hexo-deployer-git"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/hexojs/hexo-deployer-git</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://www.npmjs.com/package/hexo-generator-feed"target="_blank" rel="external nofollow noopener noreferrer">https://www.npmjs.com/package/hexo-generator-feed</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>]]></description></item></channel></rss>